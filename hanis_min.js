function PEvs(Y,rd,sd,Db,wc,M,N){var S,I,y,E,Xb,Yb,bb,da,P,La,Eb,pb,Ma,X,ea,qb,ma,r=0,J=0,aa,f,q=0,V=!1,G=function(g){da=g.target;for(La=P=0;da;)P+=da.offsetLeft-da.scrollLeft,La+=da.offsetTop-da.scrollTop,da=da.offsetParent;r=g.pageX-P-document.body.scrollLeft;J=g.pageY-La-document.body.scrollTop};this.getX=function(){return r};this.getY=function(){return J};var fa=function(g){G(g);aa=r;f=J;E=!0;null!=qb&&(Xb=(new Date).getTime());null!=Ma&&Ma(g)},ra=function(g){G(g);E=!1;null!=pb&&pb(g);null!=qb&&
(Yb=(new Date).getTime(),bb=Yb-Xb,300>bb&&qb(g))},Ia=function(g){G(g);3>Math.abs(r-aa)&&3>Math.abs(J-f)||(f=aa=-9999,E?null!=X&&X(g):null!=ea&&ea(g),null!=ma&&sa())};this.touchDown=function(g){y=!0;q+=g.changedTouches.length;if(1<q)return V=!0,g.returnValue=!0;S=g.changedTouches;I=S[0];fa(I)};this.touchUp=function(g){y=!0;q-=g.changedTouches.length;0>q&&(q=0);0==q&&(V=!1);if(V)return g.returnValue=!0;g.preventDefault();g.stopImmediatePropagation?g.stopImmediatePropagation():g.stopPropagation();S=
g.changedTouches;I=S[0];ra(I)};this.touchMove=function(g){y=!0;if(V)return g.returnValue=!0;g.preventDefault();g.stopImmediatePropagation?g.stopImmediatePropagation():g.stopPropagation();S=g.changedTouches;I=S[0];Ia(I)};this.mouseDown=function(g){y||(g.preventDefault(),g.stopImmediatePropagation?g.stopImmediatePropagation():g.stopPropagation(),fa(g))};this.clearDown=function(){E=!1};this.mouseUp=function(g){y||(g.preventDefault(),g.stopImmediatePropagation?g.stopImmediatePropagation():g.stopPropagation(),
ra(g))};this.mouseClick=function(g){g.preventDefault();g.stopImmediatePropagation?g.stopImmediatePropagation():g.stopPropagation();E=!1};this.mouseMove=function(g){y||(g.preventDefault(),g.stopImmediatePropagation?g.stopImmediatePropagation():g.stopPropagation(),Ia(g))};this.mouseDragged=function(g){y||(g.preventDefault(),g.stopImmediatePropagation?g.stopImmediatePropagation():g.stopPropagation(),G(g),null!=X&&X(g),null!=ma&&sa())};var sa=function(){clearTimeout(Eb);Eb=setTimeout(function(){ma()},
600)};f=aa=J=r=0;Ma=rd;pb=sd;ea=Db;X=wc;qb=M;ma=N;E=y=!1;Y.addEventListener("mousedown",this.mouseDown,!1);Y.addEventListener("mouseup",this.mouseUp,!1);Y.addEventListener("mousemove",this.mouseMove,!1);Y.addEventListener("click",this.mouseClick,!1);Y.addEventListener("touchstart",this.touchDown,!1);Y.addEventListener("touchend",this.touchUp,!1);Y.addEventListener("touchmove",this.touchMove,!1);Y.addEventListener("pointerdown",this.mouseDown,!1);Y.addEventListener("pointerup",this.mouseUp,!1);Y.addEventListener("pointermove",
this.mouseMove,!1);Y.addEventListener("contextmenu",function(g){g.preventDefault()},!1);Y.addEventListener("touchleave",this.touchUp,!1);Y.addEventListener("touchenter",this.touchDown,!1);Y.addEventListener("touchcancel",this.touchUp,!1);Y.addEventListener("mouseout",function(g){E||(J=r=-1,null!=ea&&ea(g));E=!1})};var HAniS=new function(){function Y(a,b,d,e,c){this.color=a;this.alpha=1;7<this.color.length&&(this.alpha=parseInt(this.color.substring(7),16)/255,this.color=this.color.substring(0,7),.1>this.alpha&&(this.alpha=.1));this.action=b;this.value=d;this.tip=e;this.poly=c;a=c.split(",");this.xy=[];this.ymin=this.xmin=9999;for(b=this.ymax=this.xmax=0;b<a.length;b++)this.xy[b]=parseInt(a[b].trim(),10),0==b%2?(this.xy[b]<this.xmin&&(this.xmin=this.xy[b]),this.xy[b]>this.xmax&&(this.xmax=this.xy[b])):(this.xy[b]<
this.ymin&&(this.ymin=this.xy[b]),this.xy[b]>this.ymax&&(this.ymax=this.xy[b]));this.height=this.ymax-this.ymin+1;this.width=this.xmax-this.xmin+1;this.can=k("canvas");this.can.height=this.height;this.can.width=this.width;this.ctx=this.can.getContext("2d");this.ctx.imageSmoothingEnabled=!1;this.ctx.fillStyle=this.color;this.ctx.globalAlpha=this.alpha;this.ctx.beginPath();this.ctx.moveTo(this.xy[0]-this.xmin,this.xy[1]-this.ymin);for(b=2;b<this.xy.length;b+=2)this.ctx.lineTo(this.xy[b]-this.xmin,this.xy[b+
1]-this.ymin);this.ctx.closePath();this.ctx.fill()}function rd(a,b,d,e,c){this.overlay=a;this.color=b;this.action=d;this.value=e;this.tip=c}function sd(a,b,d,e,c,O,g,f,s){this.x0=a;this.y0=b;this.icon=null;this.isIcon=!1;"icon"==d?(this.icon=new Image,this.icon.hotspot=this,td=!0,this.icon.onload=function(a){this.gotit=!0;this.hotspot.x1=this.hotspot.x0+this.width;this.hotspot.y1=this.hotspot.y0+this.height;this.hotspot.width=this.width;this.hotspot.height=this.height;this.hotspot.w2=this.width/2;
this.hotspot.h2=this.height/2;this.hotspot.isIcon=!0},this.y1=this.x1=-1,this.icon.gotit=!1,this.icon.src=e.trim()):(this.width=parseInt(d,10),this.height=parseInt(e,10),this.x1=this.width+a,this.y1=this.height+b,this.w2=this.width/2,this.h2=this.height/2);this.pan=c;this.isPan=!1;"pan"===this.pan&&(this.isPan=!0);this.action=O;this.value=g;this.overlay=f;this.tip=s}function Db(a,b,d,e,c,O,g){this.bg=a;null!=a&&0==this.bg.indexOf("0x")&&(this.bg="#"+this.bg.substring(2));this.fg=b;null!=b&&0==this.fg.indexOf("0x")&&
(this.fg="#"+this.fg.substring(2));this.font=d;this.fontHeight=Math.round(1.1*parseInt(d,10));this.scolor=e;null!=e&&0==this.scolor.indexOf("0x")&&(this.scolor="#"+this.scolor.substring(2));this.sblur=c;this.sxoff=O;this.syoff=g}var wc,M,N,S,I,y,E,Xb,Yb,bb,da,P,La,Eb,pb,Ma,X,ea,qb,ma,r,J,aa,f,q,V,G,fa,ra,Ia,sa,g,xc,na,Q,F,yc,Zb,Na,vd,wd,xd,Fb,K,H,p,v,ta,ua,oa,Z,D,u,pe,cb,$b,w,Gb,ac,bc,zc,c,ga,Oa,rb,Zc,yd,qe,$c,ha,Hb,sb,db,ia,Pa,tb,cc,ad,Ac,dc,Ib,Bc,Cc,eb,zd,Ad,Bd,Cd,Dd,ub,Qa,td,bd,Ed,va,ba,z,cd,ja,
ec,Ra,dd,ed,fc,L,fd,fb,Jb,wa,$,Sa,gb,Ta,Kb,gc,Ua,hb,Fd,Dc,Ec,Fc,Gd,gd,Lb,ka,Mb,Nb,Va,ib,jb,Gc,xa,pa,la,Ja,Ga,Ob,Hd,Id,Jd,re,kb,hc,Hc,ic,Kd,jc,hd,Ld,id,Pb,C,Ic,ya,Jc,Md,lb,kc,lc,Qb,Nd,Od,mb,Pd,mc,x,B,jd,Kc,nb,nc,Lc,Wa,Xa,kd,Mc,Qd,za,Ya,Nc,Oc,Rd,Pc,Sd,se,te,Td,oc,pc,ue,Ud,Rb,vb,Qc,Vd,Wd,ca,qc,Za,U,Rc,Ka,Xd,Yd,Zd,rc,Sb,ld,wb,xb,yb,$a,Tb,Sc,ve,$d,sc,md,ae,be,Ub,we,xe,ob,ce,nd,de,ee,ab,A,fe,Aa,l,zb,Ba,Ca,Da,Tc,od,ge,ye,tc,pd,Ab,qd,he,Uc,Vc,Ha,Bb,Vb,ie,Wc,je,He="N NNE NE ENE E ESE SE SSE S SSW SW WSW W WNW NW NNW N".split(" "),
Ie=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(a,10)},k=function(a){return document.createElement(a)};this.setup=function(a,b){void 0==b&&(b="MORdivcan");X=document.getElementById(b);X.align="center";ea=k("div");ea.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;");
ma=k("canvas");ma.setAttribute("style","position:absolute;top:0;left:0;z-index:1;");aa=k("canvas");aa.setAttribute("style","position:absolute;top:0;left:0;z-index:2;");f=aa.getContext("2d");f.imageSmoothingEnabled=!1;ea.appendChild(ma);ea.appendChild(aa);X.appendChild(ea);P=new PEvs(aa,HAniS.down,HAniS.up,HAniS.move,HAniS.drag,null,HAniS.canTip);X.setAttribute("tabindex",0);X.addEventListener("keydown",function(a){37==a.keyCode?(Ea(!1),Xc(-1),qa()):39==a.keyCode&&(Ea(!1),Xc(1),qa())},!0);w=0;ac=!1;
Gb=1;$b=cb=!0;G=q=0;zc=!0;Ia=null;bc=!0;ga=500;Oa=100;rb=2E3;Zc=30;yd=0;pd=6E4;Ab=null;tc=!1;xc=g=null;Kc=jd=B=x=1;Lc=!1;u=D=Z=oa=ua=ta=v=p=H=K=0;Dc=!1;va=0;td=!1;hb=null;Vc=Uc=Ha=Bb=0;Na=bd=gd=!1;Nc=Oc=oc=pc=0;Ra=Qd=Pc=Rb=Ya=!1;Jb=!0;L=fb=null;Sb=ld=fd=!1;de=[1,0,0];ee=[2,2,1];ab=[];rc=[];sb=Hb=pa=!1;Jc=Ic=0;var d=k("canvas");d.height=1;d.width=1;J=d.getContext("2d");J.imageSmoothingEnabled=!1;ed=k("canvas");La=!1;0>a.indexOf("\n")?Je(a):ze(a.split("\n"))};var ze=function(a){var b,d,e;Lb=!0;c={};
for(b=0;b<a.length;b++)2>a[b].length||(d=a[b].trim(),0==d.indexOf("#")||0>d.indexOf("=")||(d=d.split("="),e=d[0].trim().toLowerCase(),c[e]=d[1].trim()));La=!1;null!=c.debug&&("true"==c.debug?(pb=window.open("","HAniSDebugInfo","scrollbars=yes,width=400,height=200"),La=!0,W("HAniS Version 2.51")):La=!1);Qc=vb=null;null!=c.map_scale&&(Pc=Ya=!0,a=c.map_scale.split(","),vb=parseFloat(a[0]),Qc=1<a.length?parseFloat(a[1]):vb);Vd=" ";null!=c.distance_unit&&(Vd=c.distance_unit.trim());qb=" ";null!=c.divcan_style&&
(qb=c.divcan_style.trim());null!=c.imagecan_style&&(a=c.imagecan_style.trim()+";position:absolute;top:0;left:0;",ma.setAttribute("style",a+"z-index:1;"),aa.setAttribute("style",a+"z-index:2;"));b="blue";d="white";e="12px Arial";var T=null,O=10,f=10,n=10;Rd=1;Ud="white";null!=c.distance_display_style&&(a=c.distance_display_style.split(","),b=a[0].trim(),d=a[1].trim(),Ud=5<=a.length?a[4].trim():d,e=a[2].trim(),Rd=parseInt(a[3],10),5<a.length&&(T=a[5].trim(),O=parseInt(a[6],10),f=parseInt(a[7],10),n=
parseInt(a[8],10)));ue=new Db(b,d,e,T,O,f,n);b="black";d="white";e="12px Arial";T=null;n=f=O=10;null!=c.probe_display_style&&(a=c.probe_display_style.split(","),b=a[0].trim(),d=a[1].trim(),e=a[2].trim(),3<a.length&&(T=a[3].trim(),O=parseInt(a[4],10),f=parseInt(a[5],10),n=parseInt(a[6],10)));ve=new Db(b,d,e,T,O,f,n);null!=c.pause&&(yd=parseInt(c.pause,10));null!=c.auto_refresh&&(pd=6E4*parseInt(c.auto_refresh,10),Ab=setInterval("HAniS.reloadFOF();",pd),tc=!0);$c=!1;null!=c.enable_smoothing&&(a=c.enable_smoothing.trim().toLowerCase(),
"t"==a||"true"==a)&&($c=!0);null!=c.overlay_labels&&(ra=c.overlay_labels.split(","));sb=!1;db=-1;null!=c.overlay_enhance&&(sb=!0,db=parseInt(c.overlay_enhance,10)-1);fb=null;Jb=!0;if(null!=c.overlay_allow_hoverzones)for(a=c.overlay_allow_hoverzones.split(","),fb=Array(a.length),b=0;b<a.length;b++)if(fb[b]=!0,0==a[b].trim().toLowerCase().indexOf("n")||0==a[b].trim().toLowerCase().indexOf("f"))fb[b]=!1;N=M=null;wc=!1;null!=c.window_size&&(a=c.window_size.split(","),N=parseInt(a[0],10),M=parseInt(a[1],
10),wc=!0);Gc=null;if(null!=c.overlay_spacer)for(a=c.overlay_spacer.split(","),Gc=Array(a.length),b=0;b<a.length;b++)Gc[b]=parseInt(a[b],10);if(null!=c.overlay_probe_table)for(a=c.overlay_probe_table.split(","),b=0;b<a.length;b++)rc[b]=parseInt(a[b],10)-1;Ia=null;if(null!=c.overlay_order)for(a=c.overlay_order.split(","),Ia=Array(a.length),b=0;b<a.length;b++)Ia[parseInt(a[b],10)-1]=b;sa=null;if(null!=c.overlay_links)for(a=c.overlay_links.split(","),sa=Array(a.length),b=0;b<a.length;b++)sa[b]=parseInt(a[b],
10);Fb=null;if(null!=c.overlay_clear)for(a=c.overlay_clear.split(","),Fb=Array(a.length),b=0;b<a.length;b++)Fb[b]=a[b].trim().toLowerCase();yc=null;if(null!=c.overlay_transparent_amount)for(a=c.overlay_transparent_amount.split(","),yc=Array(a.length),b=0;b<a.length;b++)yc[b]=parseFloat(a[b])/100;qc=null;if(null!=ra&&null!=c.overlay_zoom)for(a=c.overlay_zoom.split(","),qc=Array(a.length),b=0;b<a.length;b++)if(qc[b]=!0,0==a[b].trim().toLowerCase().indexOf("n")||0==a[b].trim().toLowerCase().indexOf("f"))qc[b]=
!1;Za=null;if(null!=ra&&null!=c.overlay_preserve_list)for(a=c.overlay_preserve_list.split(","),Za=Array(a.length),b=0;b<a.length;b++)if(Za[b]=!0,0==a[b].trim().toLowerCase().indexOf("n")||0==a[b].trim().toLowerCase().indexOf("f"))Za[b]=!1;Jc=0;Md=" ";lb="white";kc="transparent";lc="14pt arial";Nd=!1;null!=c.times_label_style&&(a=c.times_label_style.split(","),lb=a[0].trim(),1<a.length&&(Jc=Math.floor(60*parseFloat(a[1]))),1<a.length&&(Jc="?"==a[1].trim()||"auto"==a[1].trim().toLowerCase()?-Math.floor((new Date).getTimezoneOffset()):
Math.floor(60*parseFloat(a[1]))),2<a.length&&(Md=a[2].trim()),3<a.length&&(kc=a[3].trim()),4<a.length&&(lc=a[4].trim()),5<a.length&&-1!=a[5].trim().indexOf("t")&&(Nd=!0));0==lb.indexOf("0x")&&(lb="#"+lb.substring(2));0==kc.indexOf("0x")&&(kc="#"+kc.substring(2));Qb=parseInt(lc,10);re=new Db("black","white",lc,"black",20,5,5);Od=!1;null!=c.to_from_lock&&(a=c.to_from_lock.trim(),Od=0==a.indexOf("t")?!0:!1);b="black";d="white";e="14px arial";T=null;n=f=O=10;ae=be=" ";md=Ub=null;null!=c.dirspd_display_style&&
(a=c.dirspd_display_style.split(","),b=a[0].trim(),d=a[1].trim(),e=a[2].trim(),ae=a[3],be=a[4],5<a.length&&(T=a[5].trim(),O=parseInt(a[6],10),f=parseInt(a[7],10),n=parseInt(a[8],10)),md=new Db(b,d,e,T,O,f,n));b="black";d="white";e="14px arial";T=null;n=f=O=10;null!=c.tipbox_display_style&&(a=c.tipbox_display_style.split(","),b=a[0].trim(),d=a[1].trim(),e=a[2].trim(),3<a.length&&(T=a[3].trim(),O=parseInt(a[4],10),f=parseInt(a[5],10),n=parseInt(a[6],10)));Wd=new Db(b,d,e,T,O,f,n);U=null;if(null!=ra&&
null!=Za)for(a=c.overlay_preserve.split(","),U=Array(Za.length),b=e=0;b<Za.length;b++)if(Za[b]){U[b]=Array(4);for(d=0;4>d;d++)U[b][d]=parseInt(a[e].trim(),10),e+=1;U[b][2]=U[b][2]-U[b][0]+1;U[b][3]=U[b][3]-U[b][1]+1}g=c.image_base;xc=g=null!=g?g.trim():null;Lb=!0;if(null!=c.filenames){a=c.filenames.split(",");q=a.length;V=Array(q);for(b=0;b<q;b++)V[b]=null!=g?g+a[b].trim():a[b].trim();Lb=!1;G=0}if(null!=c.basename){a=c.basename;null!=g&&(a=g+c.basename);d=c.base_starting_number;null==d&&(d=0);q=c.num_frames;
null==q&&(q=c.num_images);q=parseInt(q,10);V=Array(q);for(b=0;b<q;b++){e=b+parseInt(d,10);if(0<=a.indexOf("*"))V[b]=a.replace("*",e);else if(0<=a.indexOf("?")){for(T=a;0<=T.lastIndexOf("?");)O=T.lastIndexOf("?"),T=T.substring(0,O)+e%10+T.substring(O+1),e=Math.floor(e/10);V[b]=T}else V[b]=a+b;W("image filename = "+V[b])}null!=c.reverse_order&&0==c.reverse_order.toLowerCase().indexOf("t")&&V.reverse();Lb=!1;G=0}bd=!0;a=c.background_static;null==a||"f"!=a&&"false"!=a&&"n"!=a||(bd=!1);if(null!=c.overlay_filenames){a=
c.overlay_filenames.split(",");fa=Array(q);for(b=0;b<a.length;b++)for(e=a[b].split("&"),G=a.length,d=0;d<q;d++)0==b&&(fa[d]=Array(G)),fa[d][b]=e[d].trim(),null!=g&&(fa[d][b]=(g+fa[d][b]).trim());Lb=!1}ca=null;if(null!=c.image_preserve)for(a=c.image_preserve.split(","),ca=[],b=0;b<a.length;b++)ca[b]=parseInt(a[b].trim(),10),1<b%4&&(ca[b]=ca[b]-ca[b-2]+1);Pd=!0;null!=c.keep_zoom&&0==c.keep_zoom.trim().toLowerCase().indexOf("f")&&(Pd=!1);Vb=ie=0;null!=c.hide_bottom&&(ie=parseInt(c.hide_bottom.trim(),
10));Wc=je=0;null!=c.hide_top&&(je=parseInt(c.hide_top.trim(),10));Xd="<div>";Zd=300;Yd=500;null!=c.popup_style&&(a=c.popup_style,Xd='<div style="'+c.popup_style+'">');null!=c.popup_window_size&&(a=c.popup_window_size.split(","),Yd=a[0],Zd=a[1]);nb=!1;null!=c.active_zoom&&0==c.active_zoom.trim().toLowerCase().indexOf("t")&&(nb=!0);mc=1;null!=c.zoom_scale&&(mc=parseFloat(c.zoom_scale));nc=9999999;null!=c.maximum_zoom&&(nc=parseFloat(c.maximum_zoom));qd=!0;null!=c.use_progress_bar&&0==c.use_progress_bar.trim().toLowerCase().indexOf("f")&&
(qd=!1);null!=c.dwell?(a=c.dwell.split(","),ga=parseInt(a[0].trim(),10),1<a.length&&(Oa=parseInt(a[1].trim(),10),10>Oa&&(Oa=10),rb=parseInt(a[2].trim(),10),Zc=parseInt(a[3].trim(),10))):null!=c.rate&&(a=c.rate.split(","),ga=Math.round(1E4/parseFloat(a[0].trim())),1<a.length&&(Oa=Math.round(1E4/parseFloat(a[2].trim())),10>Oa&&(Oa=10),rb=Math.round(1E4/parseFloat(a[1].trim()))));kb=null;if(null!=c.times){a=c.times.split(",");kb=Array(a.length);for(b=0;b<a.length;b++)kb[b]=parseInt(a[b].trim(),10);Ae(kb)}jc=
null;null!=c.extrap_times_template&&(jc=RegExp(c.extrap_times_template));Id=["Click on target's initial position","Click on target's final position","Move pointer around or click here to select target"];null!=c.extrap_prompts&&(Id=c.extrap_prompts.split(","));if(null!=c.probe_table){a=new XMLHttpRequest;Aa=[];ge=[];xb=[];var s=" ";yb=[];var ud="Value=";$a=[];var m=1;zb=[];od=[];Ba=[];Ca=[];Da=[];var t,h=-1;l=-1;var k=0;a.onload=function(){for(var a=this.responseText.split("\n"),b=0;b<a.length;b++)if(!(2>
a[b].length)){var d=a[b].replace(/\s+/g," ").trim().split(","),e=d[0].split(" ");if(0==e[0].indexOf("*"))l++,Aa[l]=[],yb[l]=[],xb[l]=[],$a[l]=[],Ba[l]=[],Ca[l]=[],Da[l]=[],od[l]=[],zb[l]=[],h=-1,ge[l]=1<d.length?d[1].trim():"None",k=1;else if(0!=k){h++;var c=Array(3);Aa[l][h]=parseFloat(e[0]);Ba[l][h]=parseInt(e[1].trim(),10);Ca[l][h]=parseInt(e[2].trim(),10);Da[l][h]=parseInt(e[3].trim(),10);0!=h&&(c[0]=Ba[l][h]-Ba[l][h-1],c[1]=Ca[l][h]-Ca[l][h-1],c[2]=Da[l][h]-Da[l][h-1],t=0,Math.abs(c[1])>Math.abs(c[t])&&
(t=1),Math.abs(c[2])>Math.abs(c[t])&&(t=2),od[l][h-1]=t,zb[l][h-1]=c,0==zb[l][h-1][t]&&(zb[l][h-1][t]=1));1<d.length&&(0==d[1].trim().indexOf('"')?(m=-1,d=d[1].trim(),ud=d.substr(1,d.length-2),s=""):(m=parseInt(d[1],10),2<d.length&&(s=d[2].trim()),3<d.length&&(ud=d[3].trim())));yb[l][h]=ud;$a[l][h]=m;xb[l][h]=s}}};a.open("get",c.probe_table,!0);a.send()}Xb=c.controls;W("controls = "+c.controls);W("bottom_controls = "+c.bottom_controls);Ka=Rc=jb=ib=Nb=Mb=ka=null;null!=Xb&&Be(Xb,!0);Yb=c.bottom_controls;
null!=Yb&&Be(Yb,!1);Lb?HAniS.getFOF():(bc=!0,ke())},Je=function(a){var b=new XMLHttpRequest;b.onload=function(){ze(this.responseText.split("\n"))};b.open("get",a+"?"+Math.round(1E5*Math.random()),!0);b.send()},Ce=function(a){var b;if(null!=Fb){for(b=0;b<Fb.length;b++)-1!=Fb[b].indexOf(a)&&(F[b].checked=!1);for(b=0;b<Fb.length;b++)le(b)}},Ae=function(a){var b=0;hd=Array(a.length);for(var d=0;d<a.length;d++){var e=60*Math.floor(a[d]/100)+Math.floor(a[d])%100;0==d&&(ya=e);b=e-ya;0>b&&(b=e+1440-ya);hd[d]=
b;W("times s="+e+"  min="+hd[d])}ya+=Jc;1440<=ya&&(ya-=1440);0>ya&&(ya+=1440);W("Starting minute = "+ya)},De=function(a,b){if(0!=a)for(var d=0;d<a;d++)0==F[ba[d].overlay].isGhost&&(F[ba[d].overlay].parentNode.style.visibility=b)};this.reloadFOF=function(){W("reload FoF = "+Ab);Ce("r");Lb?HAniS.newFOF(ye):(bc=!0,ke())};this.getFOF=function(){var a=c.file_of_filenames.trim();HAniS.newFOF(a)};this.newFOF=function(a){var b,d,e,c,O,f=null!=xc?xc+a:a,n=new XMLHttpRequest,s,l,m,t,h,k;Ed=va;var r=null;gd=
!1;$b=cb;Ea(!1);va=q=0;V=[];ub=null;Qa=0;ja=null;ec=0;Ra=dd=!1;wa=null;gc=!1;$=-1;Kb=Ta=gb=Sa=null;Fd=-1;fa=[];var p=!1;if(null==kb||null!=jc)kb=[];W("new FOF="+f);pa&&(null!=xa&&(xa.innerHTML=xa.label_on,X.style.cursor="default",Ea($b),la=-1),pa=!1,Fa());n.onload=function(){var a=this.responseText.split("\n");for(b=0;b<a.length;b++)if(!(2>a[b].length)&&(s=a[b].trim(),W("FOF: "+s),0!=s.indexOf("#")))if(0==s.indexOf("fof_extension"))h=s.split("="),r=h[1].trim();else if(0==s.indexOf("image_base"))h=
s.split("="),g=h[1].trim();else if(0==s.indexOf("high_res_basemap")){h=s.split("=");k=h[1].split(",");gb=[];for(d=0;d<k.length;d++)gb[d]=k[d].trim(),null!=g&&(gb[d]=g+gb[d]);gc=!0}else if(0==s.indexOf("high_res_overlay")){h=s.split("=");k=h[1].split(",");Fd=parseInt(k[0].trim(),10)-1;Kb=[];for(d=1;d<k.length;d++)Kb[d-1]=k[d].trim(),null!=g&&(Kb[d-1]=g+Kb[d-1]);gc=!0}else if(0==s.indexOf("high_res_zoom")){h=s.split("=");k=h[1].split(",");wa=[];for(d=0;d<k.length;d++)wa[d]=parseFloat(k[d].trim());me()}else if(0==
s.indexOf("hoverzone"))Ke(s);else if(0==s.indexOf("hotzone"))Ee(s);else if(0==s.indexOf("hotspot"))Le(s);else if(0==s.indexOf("toggle_onoff")&&(h=s.split("="),Ec=h[1].split(",")),0==s.indexOf("map_scale"))h=s.split("="),k=h[1].split(","),vb=parseFloat(k[0]),Qc=1<k.length?parseFloat(k[1]):vb;else if(0==s.indexOf("times")){h=s.split("=");k=h[1].split(",");for(b=0;b<k.length;b++)kb[b]=parseInt(k[b].trim(),10);p=!0}else{if(null!=jc){var f=s.match(jc);null!=f&&2==f.length?(kb.push(parseInt(f[1],10)),W("+ + + Extrap time = "+
f[1]),p=!0):W("+ + + Cannot parse times using "+jc+" from line: "+s)}e=s.indexOf(" ");0>e&&(e=s.length);V[q]=s.substring(0,e).trim();null!=g&&(V[q]=g+V[q]);s=s.substring(e+1);c=s.indexOf('"');0<=c&&(null==Ua&&(Ua=[]),e=s.substring(c+1),c=e.indexOf('"'),0<=c&&(Ua[q]=e.substring(0,c),0==q&&(hb.innerHTML=Ua[0])));fa[q]=[];c=s.indexOf("overlay");if(0<=c)for(l=s.substring(c),c=l.indexOf("="),0>c&&W("Cannot find a = sign in "+l),m=l.substring(c+1),l=m.trim(),m=l.split(","),G=m.length,W("numOverlays set to "+
G),O=0;O<m.length;O++)fa[q][O]=m[O].trim(),null!=g&&(fa[q][O]=(g+fa[q][O]).trim());q+=1}p&&Ae(kb);null!=r?(a=new XMLHttpRequest,a.onload=function(){var a=this.responseText.split("\n");for(b=0;b<a.length;b++)2>a[b].length||(t=a[b].trim(),W("ext_FOF: "+t),0!=t.indexOf("#")&&0==t.indexOf("hotzone")&&Ee(t));ne()},a.onerror=function(){ne()},a.open("get",r+"?"+Math.round(1E5*Math.random()),!0),a.send()):ne()};ye=a;n.open("get",f+"?"+Math.round(1E5*Math.random()),!0);n.send()};var ne=function(){0!=va?De(va,
"visible"):0!=Ed&&De(Ed,"hidden");bc=!0;ke()},ke=function(){var a,b,d,e="?"+Math.round(1E4*Math.random());na=Array(q);Bb=Ha=0;he=qd;Qd&&(Xa.max=q-1);zc&&(Hb||sb)&&(Pa=[],ia=[],tb=[],ad=[],Ac=[]);null!=ha&&(ha.selectedIndex=0);for(a=0;a<q;a++){zc&&(Hb||sb)&&(Pa[a]=k("canvas"),ia[a]=k("canvas"));na[a]=new Image;na[a].gotit=!1;na[a].frameNum=a;na[a].onerror=function(){Ha++};na[a].onload=function(){zc&&(zc=!1,S=this.height,I=this.width,Z=S,oa=I,wc?(ma.height=M,ma.width=N,aa.height=M,aa.width=N):(ma.height=
Z,ma.width=oa,aa.height=Z,N=aa.width=oa,M=Z),Uc=N/2-100,Vc=M/2-10,y=1*oa/N,E=1*Z/M,ea.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;"+qb+"height:"+M+"px;width:"+N+"px;"));if(0<ec&&!dd){ed.height=S;ed.width=I;fc=ed.getContext("2d");fc.clearRect(0,0,N,M);for(var a=0;a<ja.length;a++){for(var c=ja[a].ctx.getImageData(0,0,ja[a].width,ja[a].height).data,
g=fc.getImageData(ja[a].xmin,ja[a].ymin,ja[a].width,ja[a].height),T=3;T<c.length;T+=4)0!=c[T]&&(g.data[T]=a+1);fc.putImageData(g,ja[a].xmin,ja[a].ymin)}nb||(Ra=!0);dd=!0}if(bc){bc=!1;r=ma.getContext("2d");r.imageSmoothingEnabled=$c;r.fillStyle="blue";r.font="bold 20px Arial";f=aa.getContext("2d");f.imageSmoothingEnabled=$c;dc=Array(q);Dc&&Me(q);if(0<G)for(Q=Array(q),d=0;d<q;d++)for(Q[d]=Array(G),b=0;b<G;b++)Q[d][b]=new Image,Q[d][b].gotit=!1,Q[d][b].frameNum=d,Q[d][b].overlayNum=b,Q[d][b].onerror=
function(){Ha++},Q[d][b].onload=function(){this.gotit=!0;Ha++;Yc();if(this.height!=S||this.width!=I)this.gotit=!1,W("Bad image size:"+this.src);if(sb&&this.gotit&&this.overlayNum==db){var a=this.frameNum;Pa[a].height=this.height;Pa[a].width=this.width;cc=Pa[a].getContext("2d");cc.drawImage(this,0,0);ad[a]=cc.getImageData(0,0,this.width,this.height).data;ia[a].height=this.height;ia[a].width=this.width;tb[a]=ia[a].getContext("2d");tb[a].drawImage(this,0,0);Ac[a]=tb[a].getImageData(0,0,this.width,this.height);
Q[a][this.overlayNum]=null;Q[a][this.overlayNum]=ia[a];Q[a][this.overlayNum].gotit=!0}},a=fa[d][b],void 0==Zb||Zb[b]||(a=fa[d][b]+e),Q[d][b].src=a,Bb++;if(null!=gb)for(Sa=[],b=0;b<gb.length;b++)Sa[b]=new Image,Sa[b].gotit=!1,Sa[b].onerror=function(a){Ha++},Sa[b].onload=function(a){a.currentTarget.gotit=!0;Ha++;Yc()},Sa[b].src=gb[b],Bb++;if(null!=Kb)for(Ta=[],b=0;b<gb.length;b++)Ta[b]=new Image,Ta[b].gotit=!1,Ta[b].onerror=function(a){Ha++},Ta[b].onload=function(a){a.currentTarget.gotit=!0;Ha++;Yc()},
Ta[b].src=Kb[b],Bb++}this.height==S&&this.width==I?this.gotit=!0:(this.gotit=!1,W("Image has invalid size:"+this.src));Hb&&this.gotit&&(a=this.frameNum,Pa[a].height=this.height,Pa[a].width=this.width,cc=Pa[a].getContext("2d"),cc.drawImage(this,0,0),ad[a]=cc.getImageData(0,0,this.width,this.height).data,ia[a].height=this.height,ia[a].width=this.width,tb[a]=ia[a].getContext("2d"),tb[a].drawImage(this,0,0),Ac[a]=tb[a].getImageData(0,0,this.width,this.height),na[a]=null,na[a]=ia[a],na[a].gotit=!0);Ha++;
Yc();pe||(pe=!0,Ea(!0),Fe());Ea($b);Pd||HAniS.resetZoom();gd=!0};var c=V[a];bd||(c=V[a]+e);na[a].src=c;Bb++}Rb=Na=!1;Fa()},Cb=function(a,b,d,e,g){a.label_on=d;a.label_off=e;d=null;e=c[b+"_labels"];null==e&&(e=c[b+"_label"]);null!=e&&(e=e.split(","),a.label_on=e[0].trim(),1<e.length&&(a.label_off=e[1].trim()),2<e.length&&(d="width:"+e[2].trim()+"px;"));null!=g&&(a.title=g);a.innerHTML=a.label_on;b=(null!=d?d:"")+Ma+c[b+"_style"];null!=b&&a.setAttribute("style",b)},Be=function(a,b){var d,e,g,f;Ma=c.buttons_style;
var r=null,n=null,r=b?c.controls_tooltip:c.bottom_controls_tooltip,s=a.split(",");null!=r&&(g=r.split(","),g.length!=s.length&&(W("!!! Number of tooltips must equal number of controls!"),g=r=null));var p=null,m;for(d=0;d<s.length;d++){m=null!=r?g[d]:null;var t=s[d].trim(),h=t.indexOf("/");if(0===h||0===d)0===h&&(t=t.substring(1)),f=k("div"),f.align="center",null!=c.controls_style?f.setAttribute("style",c.controls_style):f.setAttribute("style","position:relative;padding:2px;width:100%;"),b?X.insertBefore(f,
ea):(null!=c.bottom_controls_style&&f.setAttribute("style",c.bottom_controls_style),X.appendChild(f));h=c.enhance_filename;null==h&&(h=c.enhance_table);if("enhance"==t.trim()&&null!=h){ha=k("select");n=c.enhance_style;null!=n&&ha.setAttribute("style",n);null!=m&&(ha.title=m);n=k("option");n.innerHTML="Pick Enhancement";n.value=-1;ha.add(n);ha.addEventListener("change",HAniS.doEnhance,!1);Hb=!sb;ha.disabled=Hb?!1:!0;f.appendChild(ha);n=new XMLHttpRequest;Aa=[];xb=[];yb=[];$a=[];var v,y,z;Ba=[];Ca=
[];Da=[];Tc=[];l=-1;var A=!1,u,C,x,B,E,D,N,G,P,M,Q,L,S;n.onload=function(){for(var a=this.responseText.split("\n"),b=0;b<a.length;b++)if(!(2>a[b].length)){var d=a[b].replace(/\s+/g," ").trim(),e=d.indexOf("#");if(0!=e)if(0<e&&(d=d.substring(0,e)),0==d.indexOf("*"))l++,Aa[l]=Array(256),yb[l]=Array(256),xb[l]=Array(256),$a[l]=Array(256),Ba[l]=Array(256),Ca[l]=Array(256),Da[l]=Array(256),Tc[l]=Array(256),Aa[l]=Array(256),v=" ",y="Value =",z=1,e=k("option"),e.innerHTML=d.substring(1),e.value=l,ha.add(e);
else{var c=d.indexOf("value");0>c&&(c=d.indexOf("probe"));A=!1;M=Q=0;0<c&&(e=d.substring(c+1),d=d.substring(0,c),c=e.indexOf("="),e=e.substring(c+1),e=e.split(","),1==e.length?(y=e[0].trim(),z=-1,A=!1):(M=parseFloat(e[0].trim()),Q=parseFloat(e[1].trim()),2<e.length&&(z=parseInt(e[2],10)),3<e.length&&(v=e[3].trim()),4<e.length&&(y=e[4].trim()),A=!0));d=d.split(" ");u=parseInt(d[0].trim(),10);C=parseInt(d[1].trim(),10);x=C-u;B=parseFloat(d[2].trim());E=parseFloat(d[3].trim());D=parseFloat(d[4].trim());
N=parseFloat(d[5].trim());G=parseFloat(d[6].trim());P=parseFloat(d[7].trim());L=S=255;9<d.length&&(L=parseFloat(d[8].trim()),S=parseFloat(d[9].trim()));for(d=u;d<=C;d++)0==x?(Ba[l][u]=B,Ca[l][u]=D,Da[l][u]=G,Tc[l][u]=L):(Ba[l][d]=Math.round(B+(E-B)*(d-u)/x),Ca[l][d]=Math.round(D+(N-D)*(d-u)/x),Da[l][d]=Math.round(G+(P-G)*(d-u)/x),Tc[l][d]=Math.round(L+(S-L)*(d-u)/x)),yb[l][d]=y,xb[l][d]=v,$a[l][d]=z,A&&(Aa[l][d]=M+(Q-M)*(d-u)/x)}}};n.open("get",h,!0);n.send()}"startstop"==t&&(ka=k("button"),Cb(ka,
"startstop","Start","Stop",m),ka.addEventListener("click",HAniS.toggleIsLooping,!1),f.appendChild(ka));"looprock"==t&&(Wa=k("button"),Cb(Wa,"looprock","Rock","Loop",m),Gb=1,Wa.addEventListener("click",HAniS.toggleLoopRock,!1),f.appendChild(Wa));"extrap"==t&&(xa=k("button"),Cb(xa,"extrap","Enable Extrap","Disable Extrap",m),xa.addEventListener("click",HAniS.toggleExtrap,!1),f.appendChild(xa));"distance"==t&&(za=k("button"),Cb(za,"distance","Show dist","Hide dist",m),Ya=Pc=!1,za.addEventListener("click",
function(){Ya=!Ya;za.innerHTML=Ya?za.label_off:za.label_on},!1),f.appendChild(za));"probe"==t&&(wb=k("button"),Cb(wb,"probe","Show probe","Hide probe",m),Sb=ld=!1,$d="Undefined",sc=0,null!=c.probe_undefined&&(h=c.probe_undefined.split(","),$d=h[0].trim(),1<h.length&&(sc=parseInt(h[1],10)+1)),wb.addEventListener("click",function(){(ld=!ld)?(wb.innerHTML=wb.label_off,Sb=!0):(wb.innerHTML=wb.label_on,Sb=!1)},!1),f.appendChild(wb));"refresh"==t&&(Rc=k("button"),Cb(Rc,"refresh","Refresh",null,m),Rc.addEventListener("click",
HAniS.reloadFOF,!1),f.appendChild(Rc));"setframe"==t&&(Xa=k("input"),Xa.type="range",Xa.min=0,Xa.max=99,Xa.value=0,kd="Frame #*",null!=c.setframe_label&&(kd=c.setframe_label),Mc=k("span"),Mc.innerHTML=kd.replace("*",1),n="display:block;vertical-align:middle;"+c.setframe_style,Xa.setAttribute("style",n),h=k("span"),h.setAttribute("style","display:inline-block;vertical-align:top;"),Mc.setAttribute("style","display:block;vertical-align:middle;"+c.setframe_label_style),h.appendChild(Mc),h.appendChild(Xa),
f.appendChild(h),Xa.addEventListener("input",function(a){Ea(!1);uc(parseInt(Xa.value,10));Mc.innerHTML=kd.replace("*",w+1);qa()},!1),Qd=!0);"framelabel"==t&&(hb=k("button"),hb.innerHTML="",Ua=null,null!=c.frame_labels&&(Ua=c.frame_labels.split(","),hb.innerHTML=Ua[0]),n=Ma+c.framelabel_style,null!=n&&hb.setAttribute("style",n),f.appendChild(hb));if("autorefresh"==t||"autorefresh/off"==t)null!=Ab&&clearInterval(Ab),Ka=k("button"),Cb(Ka,"autorefresh","Disable Auto Refresh","Enable Auto Refresh",m),
Ka.addEventListener("click",HAniS.toggleAutoRefresh,!1),tc=!1,f.appendChild(Ka),"autorefresh"==t?HAniS.toggleAutoRefresh():Ka.innerHTML=Ka.label_off;"step"==t&&(h=c.step_labels,h=null!=h?h.split(","):["<",">"],Nb=k("button"),Nb.innerHTML=h[0],Nb.addEventListener("click",function(){Ea(!1);Xc(-1);qa()},!1),n=Ma+c.step_style,null!=n&&Nb.setAttribute("style",n),null!=m&&(Nb.title=m),f.appendChild(Nb),Mb=k("button"),Mb.innerHTML=h[1],Mb.addEventListener("click",function(){Ea(!1);Xc(1);qa()},!1),null!=
n&&Mb.setAttribute("style",n),null!=m&&(Mb.title=m),f.appendChild(Mb));"firstlast"==t&&(h=c.firstlast_labels,h=null!=h?h.split(","):["<<",">>"],bb=k("button"),bb.innerHTML=h[0],bb.addEventListener("click",function(){Ea(!1);uc(0);qa()},!1),n=Ma+c.firstlast_style,null!=n&&bb.setAttribute("style",n),null!=m&&(bb.title=m),f.appendChild(bb),da=k("button"),da.innerHTML=h[1],da.addEventListener("click",function(){Ea(!1);uc(q-1);qa()},!1),null!=n&&da.setAttribute("style",n),null!=m&&(da.title=m),f.appendChild(da));
"setspeed"==t?(Va=k("input"),Va.type="range",Va.min=Oa,Va.max=rb,Va.value=rb-ga,null!=m&&(Va.title=m),n="vertical-align:middle;"+c.setspeed_style,Va.setAttribute("style",n),Va.addEventListener("input",function(a){ga=rb-parseInt(Va.value,10)+30;Ea(!0);qa()},!1),f.appendChild(Va)):"speed"==t&&(h=c.speed_labels,h=null!=h?h.split(","):["-","+"],jb=k("button"),jb.innerHTML=h[0],jb.addEventListener("click",function(){ga+=Zc;ib.disabled=!1;ga>rb&&(ga=rb,jb.disabled=!0)},!1),n=Ma+c.speed_style,null!=n&&jb.setAttribute("style",
n),null!=m&&(jb.title=m),f.appendChild(jb),ib=k("button"),ib.innerHTML=h[1],ib.addEventListener("click",function(){ga-=Zc;jb.disabled=!1;ga<Oa&&(ga=Oa,ib.disabled=!0)},!1),null!=n&&ib.setAttribute("style",n),null!=m&&(ib.title=m),f.appendChild(ib));"zoom"==t&&(mb=k("button"),Cb(mb,"zoom","Zoom","Un-zoom",m),mb.addEventListener("click",HAniS.toggleZooming,!1),f.appendChild(mb));"toggle"==t&&(dc=[],h=c.toggle_size,null!=h?(h=h.split(","),Ib=parseInt(h[0],10),Bc=parseInt(h[1],10),Cc=parseInt(h[2],10)):
(Bc=Ib=10,Cc=3),Bd="red",Cd="blue",Dd="orange",h=c.toggle_colors,null!=h&&(h=h.split(","),Cd=h[0].trim(),Bd=h[1].trim(),Dd=h[2].trim()),eb=k("div"),eb.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;"),eb.style.backgroundColor=f.style.backgroundColor,eb.align="center",Ad=new PEvs(eb,null,null,null,null,HAniS.togclick,null),Fc=k("canvas"),Fc.height=
2*Bc,Gd=Fc.getContext("2d"),eb.appendChild(Fc),b?X.insertBefore(eb,ea):X.appendChild(eb),h=c.toggle_onoff,Ec=null,null!=h&&(Ec=h.split(",")),Dc=!0,null!=m&&(eb.title=m));if("overlay"==t){F=[];t=c.overlay_tooltip;m=null;null!=t&&(m=t.split(","));t=c.overlay_radio;h=null;null!=t&&(h=t.split(","));var J=c.overlay_labels_color,n=null;null!=J&&(n=J.split(","));Zb=[];e=c.overlay_caching;J=null;null==e&&(e=c.overlay_static);null!=e&&(J=e.split(","));var V=!0;null!=c.overlay_nonewdiv&&(V=!1);for(e=0;e<ra.length;e++){var R=
ra[e].trim();if(0==e||0==R.indexOf("/"))0==R.indexOf("/")&&(R=R.substr(1)),V?(p=k("div"),p.align="center",b?X.insertBefore(p,ea):X.appendChild(p)):(p=k("span"),f.appendChild(p)),null!=c.overlay_labels_style&&p.setAttribute("style",c.overlay_labels_style);var K=!1,H=R.length;0<R.indexOf("/on")&&R.indexOf("/on")==H-3&&(K=!0,R=R.substr(0,H-3));var I=!1;0<R.indexOf("/always")&&R.indexOf("/always")==H-7&&(I=K=!0);var U=!1;0<R.indexOf("/hidden")&&R.indexOf("/hidden")==H-7&&(U=!0);null!=J?"y"==J[e].trim().toLowerCase()||
"t"==J[e].trim().toLowerCase()?Zb[e]=!0:Zb[e]=!1:Zb[e]=!0;F[e]=k("input");F[e].type="checkbox";F[e].value=R;H="vertical-align:middle;";null!=c.checkbox_style&&(H+=c.checkbox_style);F[e].setAttribute("style",H);F[e].checked=K;null!=ha&&e==db&&F[e].checked&&(ha.disabled=!1);null!=fb&&!fb[e]&&K&&(Jb=!1);F[e].addEventListener("click",HAniS.overClick,!1);null!=t&&-1!=h[e].indexOf("true")&&(F[e].type="radio",K=h[e].indexOf("/"),F[e].name=-1!=K?h[e].substr(K+1).trim():"all");F[e].isGhost=!0;I||U||(null!=
m&&(F[e].title=m[e]),I=k("label"),I.htmlFor=R,null!=m&&(I.title=m[e]),I.appendChild(document.createTextNode(R)),R="vertical-align:middle;",null!=n&&(R=R+"color:"+n[e]+";"),I.setAttribute("style",R),R=k("span"),U="10",null!=Gc&&(U=10+Gc[e]),R.setAttribute("style","margin-left:"+U+"px;"),R.appendChild(F[e]),R.appendChild(I),p.appendChild(R),F[e].isGhost=!1)}if(null==sa)for(sa=Array(ra.length),e=0;e<ra.length;e++)sa[e]=0;else for(e=0;e<ra.length;e++)le(e)}}},le=function(a){var b,d;if(0>sa[a]){d=!1;for(b=
0;b<ra.length;b++)sa[b]!=-sa[a]||d||(d=F[b].checked);F[a].checked=d}},Le=function(a){0==Qa&&(ub=[]);a=a.split("=")[1].split(",");var b=a[4].trim(),d=a[4].indexOf("/"),e=-1;-1!=d&&(e=parseInt(a[4].substring(d+1),10)-1,b=b.substring(0,d));ub[Qa]=new sd(parseInt(a[0].trim(),10),parseInt(a[1].trim(),10),a[2].trim(),a[3].trim(),b.toLowerCase(),a[5].trim().toLowerCase(),a[6].trim(),e,8==a.length?a[7].trim():null);Qa+=1},Ke=function(a){0==ec&&(ja=[],L=null);var b=a.split("=")[1].split("(");a=b[0].split(",");
var d=a[0].trim();0==d.indexOf("0x")&&(d="#"+d.substring(2));ja[ec]=new Y(d,a[1].trim(),a[2].trim(),a[3].trim(),b[1].trim());ec+=1},Ee=function(a){0==va&&(ba=[]);a=a.split("=")[1].split(",");ba[va]=new rd(parseInt(a[0],10)-1,parseInt(a[1],16),a[2].trim(),a[3].trim(),5==a.length?a[4].trim():"Click for details");va+=1};this.drag=function(a){K=P.getX();H=P.getY();p=K*y;v=H*E;Rb=Na=!1;Ya&&(!Pc||Pc&&a.shiftKey)?(oc=p,pc=v,Rb=!0):(nb&&B!=Kc?(D=(ta*x-p)/x,u=(ua*B-v)/B,0>D&&(D=0),u<Wc&&(u=Wc),D+oa>I&&(D=
I-oa),u+Z>S-Vb&&(u=S-Vb-Z),D=Math.round(D),u=Math.round(u),ta=Math.round(D+p/x),ua=Math.round(u+v/B)):!pa&&Ra&&(L=null,Jb&&0<=p&&0<=v&&(z=fc.getImageData(p,v,1,1).data,0!=z[3]&&(L=ja[z[3]-1]))),Lc=!0,qa());Fa()};var me=function(){if(gc){$=-1;for(var a=0;a<wa.length;a++)x>=wa[a]&&($=a)}},oe=function(a,b){"popup"==a.action?(null!=Eb&&Eb.close(),Eb=window.open("","HAniSPopup","scrollbars=yes,width="+Yd+",height="+Zd),Eb.document.write(Xd+a.value+"</div>")):"link"==a.action?window.open(a.value,"_blank",
""):"fof"==a.action&&(g=xc,HAniS.resetZoom(),HAniS.newFOF(a.value),Ce(b))};this.resetZoom=function(){x=jd;B=Kc;null!=mb&&(mb.innerHTML=mb.label_on,nb=!1);ta=p;ua=v;u=D=0;Z=S;oa=I;me();qa();dd&&(Ra=!0)};this.canTip=function(){var a;Na=!1;K=P.getX();p=K*y;H=P.getY();v=H*E;if(!(pa&&v<Jd&&p>Hd)){ta=Math.round(D+p/x);ua=Math.round(u+v/B);if(0!=va)for(a=0;a<va;a++)if(ba[a].overlay>=G)W(" Error...hotzone overlay # "+ba[a].overlay+" > number of overlays = "+G);else if(F[ba[a].overlay].checked&&(J.clearRect(0,
0,1,1),J.drawImage(Q[w][ba[a].overlay],ta,ua,1,1,0,0,1,1),z=J.getImageData(0,0,1,1).data,cd=(z[0]<<16)+(z[1]<<8)+z[2],cd==ba[a].color)){Na=!0;wd=K;xd=H;vd=ba[a].tip;break}if(0!=Qa){var b,d,e,c;for(a=0;a<Qa;a++)if(c=ub[a],-1==c.overlay||F[c.overlay].checked)if(e=!1,c.isPan?c.isIcon?(b=(c.x0-D)*x-c.w2,d=(c.y0-u)*B-c.h2,p>b&&p<b+c.width&&v>d&&v<d+c.height&&(e=!0)):(b=(c.x0-D)*x,d=(c.y0-u)*B,p>b&&p<b+c.width*x&&v>d&&v<d+c.height*B&&(e=!0)):p>c.x0&&p<c.x1&&v>c.y0&&v<c.y1&&(e=!0),e&&null!=c.tip){Na=!0;
wd=K;xd=H;vd=ub[a].tip;break}}Fa()}};this.move=function(){if(!pa&&Ra&&(L=null,Jb)){var a=P.getX()*y,b=P.getY()*E;0<=a&&0<=b&&(z=fc.getImageData(a,b,1,1).data,0!=z[3]&&(L=ja[z[3]-1]))}pa&&2<=la&&(K=P.getX(),p=K*y,H=P.getY(),v=H*E);Fa()};this.down=function(){Na&&(Na=!1,Fa());K=P.getX();p=K*y;H=P.getY();v=H*E;Nc=p;Oc=v;oc=Nc;pc=Oc;ta=Math.round(D+p/x);ua=Math.round(u+v/B);Lc=!1};this.up=function(a){Na=!1;if(pa){K=P.getX();p=K*y;H=P.getY();v=H*E;if(3>la)if(Ja[la]=p,Ga[la]=v,Ob[la]=hd[w],0==la)la=1,uc(q-
1),Ic=1,Ub=null;else{Kd=Ob[1]-Ob[0];Hc=(Ja[1]-Ja[0])/Kd;ic=(Ga[1]-Ga[0])/Kd;if(null!=md&&null!=vb){var b=Hc*vb,d=ic*Qc,e=Math.round(60*Math.sqrt(b*b+d*d)),b=Math.atan2(b,-d)/.0174533;0>b&&(b+=360);Ub=ae+He[Math.round(b/22.5)]+" at "+e+" "+be;we=Ja[0];xe=0<ic?Ga[0]-15:Ga[0]+30}e=parseInt(lc,10);C=Math.round(Math.abs(4*(e+4)/Hc));Pb=Math.round(Math.abs(2*(e+4)/ic));Pb<C&&(C=Pb);120<C?C=120*Math.floor(C/120)+60:90<C?C=120:60<C?C=90:30<C?C=60:15<C?C=30:10<C?C=15:5<C?C=10:2<C?C=5:0==C&&(C=1);Pb=Ob[1]/
C*C+C;hc=1;Od&&(hc=-1);Ld=Hc*C;id=ic*C;uc(q-1);la=3;Ic=2}else if(v<Jd&&p>Hd&&3==la){Ge();Fa();return}Fa()}if(Rb)Rb=!1,Fa();else if(null!=za&&nb&&(Ya=!1,za.innerHTML=za.label_on),Lc)Lc=!1;else if(a.altKey)HAniS.resetZoom();else if(Ra&&null!=L&&fd)oe(L,"z");else{K=P.getX();p=K*y;H=P.getY();v=H*E;if(0!=va)for(e=0;e<va;e++)if(ba[e].overlay>=G)W(" Error...hotzone overlay # "+ba[e].overlay+" > number of overlays = "+G);else if(F[ba[e].overlay].checked&&(J.clearRect(0,0,1,1),J.drawImage(Q[w][ba[e].overlay],
Math.floor(ta),Math.floor(ua),1,1,0,0,1,1),z=J.getImageData(0,0,1,1).data,cd=(z[0]<<16)+(z[1]<<8)+z[2],cd==ba[e].color)){oe(ba[e],"z");return}if(0!=Qa)for(var c,f,e=0;e<Qa;e++)if(f=ub[e],-1==f.overlay||F[f.overlay].checked)if(c=!1,f.isPan?f.isIcon?(b=(f.x0-D)*x-f.w2,d=(f.y0-u)*B-f.h2,p>b&&p<b+f.width&&v>d&&v<d+f.height&&(c=!0)):(b=(f.x0-D)*x,d=(f.y0-u)*B,p>b&&p<b+f.width*x&&v>d&&v<d+f.height*B&&(c=!0)):p>f.x0&&p<f.x1&&v>f.y0&&v<f.y1&&(c=!0),c){oe(ub[e],"s");return}nb&&(Ra=!1,a.ctrlKey?(x-=.1*mc,B-=
.1*mc):(x+=.1*mc,B+=.1*mc,x>nc&&(x=nc),B>nc&&(B=nc)),x<jd||B<Kc?(x=jd,B=Kc,ta=p,ua=v,u=D=0,Z=S,oa=I,Wc=Vb=0):(D=(ta*x-p)/x,u=(ua*B-v)/B,Z=Math.floor(S/B),u+Z>S-Vb&&(u=S-Vb-Z),oa=Math.floor(I/x),u=Math.round(u),D=Math.round(D),Vb=ie,Wc=je),me());qa();Fa()}};this.toggleAutoRefresh=function(){tc?(Ka.innerHTML=Ka.label_off,null!=Ab&&clearInterval(Ab),tc=!1):(Ka.innerHTML=Ka.label_on,Ab=setInterval("HAniS.reloadFOF();",pd),tc=!0)};this.toggleLoopRock=function(){ac?(null!=Wa&&(Wa.innerHTML=Wa.label_on),
ac=!1):(null!=Wa&&(Wa.innerHTML=Wa.label_off),ac=!0)};this.toggleExtrap=function(){pa?(null!=xa&&(xa.innerHTML=xa.label_on,X.style.cursor="default",null!=ka&&(ka.disabled=!1),Ea($b),la=-1),pa=!1,Fa()):(null!=xa&&(pa=!0,Ub=null,X.style.cursor="crosshair",xa.innerHTML=xa.label_off,$b=cb,null!=ka&&(ka.disabled=!0),cb=!1,HAniS.resetZoom(),Ge(),Fa()),qa())};var Ge=function(){Ic=0;Ja=Array(2);Ga=Array(2);Ob=Array(2);la=0;Ub=null;uc(0)},Ea=function(a){cb=!a;HAniS.toggleIsLooping()};this.doEnhance=function(a){if(Hb||
sb){var b=ia[0].height,d=ia[0].width;a=parseInt(ha.value,10);var c,f,g,l;0<=a&&(c=Ba[a],f=Ca[a],g=Da[a],l=Tc[a],rc[db]=a);for(var d=b*d*4,n=0;n<Pa.length;n++)if(ia[n].gotit){ia[n].gotit=!1;var k=Ac[n].data,p=ad[n];if(0>a)for(var m=0;m<d;m+=4)k[m]=p[m],k[m+1]=p[m+1],k[m+2]=p[m+2],k[m+3]=p[m+3];else for(m=0;m<d;m+=4)b=p[m],b===p[m+1]&&b===p[m+2]&&(k[m]=c[b],k[m+1]=f[b],k[m+2]=g[b],k[m+3]=l[b]);tb[n].putImageData(Ac[n],0,0);ia[n].gotit=!0}}};this.overClick=function(a){var b;Jb=!0;for(b=0;b<sa.length;b++)a.target!=
F[b]&&le(b),null!=fb&&!fb[b]&&F[b].checked&&(Jb=!1),null!=ha&&b==db&&(ha.disabled=!F[b].checked);qa()};this.toggleIsLooping=function(){cb?(cb=!1,null!=ka&&(ka.innerHTML=ka.label_on)):(cb=!0,null!=ka&&(ka.innerHTML=ka.label_off))};this.toggleZooming=function(){nb?HAniS.resetZoom():(mb.innerHTML=mb.label_off,nb=!0,null!=za&&(Ya=!1,za.innerHTML=za.label_on),Ra=!1,pa&&HAniS.toggleExtrap())};var Wb=function(a,b){dc[a]=b;if(Dc){var d=zd+a*(Ib+Cc),c=Dd;0==b?c=Cd:-1==b&&(c=Bd);Gd.fillStyle=c;Gd.fillRect(d,
Bc/2,Ib,Bc)}};this.togclick=function(a){var b=Ad.getX();Ad.getY();var d=zd;for(a=0;a<dc.length;a++){if(b>d&&b<d+Ib){b=0;0<=dc[a]&&(b=-1);Wb(a,b);break}d=d+Ib+Cc}};var Me=function(a){Dc&&(Fc.width=N,zd=N/2-a*(Ib+Cc)/2);for(var b=0;b<a;b++)null!=Ec&&"n"==Ec[b].toLowerCase().trim()?Wb(b,-1):Wb(b,0)},uc=function(a){Wb(w,0);w=a;Wb(w,1)},Xc=function(a){Wb(w,0);do 0<a?(w+=1,w>=q&&(ac?(w=q-1,Gb=-Gb):w=0)):(w-=1,0>w&&(ac?(w=0,Gb=-Gb):w=q-1));while(0>dc[w]);Wb(w,1);null!=hb&&null!=Ua&&null!=Ua[w]&&(hb.innerHTML=
Ua[w])},vc=function(a,b,d,c,g){f.globalAlpha=1;f.font=a.font;var k=a.fontHeight;d=d-k-6;var l=f.measureText(c).width;1==g&&(b-=l);0==g&&(b-=l/2);5>b&&(b=5);5>d&&(d=5);d+k+3>M&&(d=M-k-6);b+3+l>N&&(b=N-l-6);f.save();f.beginPath();f.fillStyle=a.bg;null!=a.scolor&&(f.shadowColor=a.scolor,f.shadowBlur=a.sblur,f.shadowOffsetX=a.sxoff,f.shadowOffsetY=a.syoff);Sd=b-3;se=d;te=l+6;Td=k+6;f.fillRect(Sd,se,te,Td);f.closePath();f.restore();f.textBaseline="bottom";f.fillStyle=a.fg;f.fillText(c,b,d+k+3)},Fa=function(){f.clearRect(0,
0,N,M);fd=!1;if(pa){f.beginPath();f.lineWidth=2;f.strokeStyle="white";var a=la;1<a&&(a=2);for(var b=0;b<a;b++)1<la&&(f.moveTo(Ja[0],Ga[0]),f.lineTo(Ja[1],Ga[1])),f.moveTo(Ja[b]-15,Ga[b]),f.lineTo(Ja[b]+15,Ga[b]),f.moveTo(Ja[b],Ga[b]-15),f.lineTo(Ja[b],Ga[b]+15);f.closePath();f.stroke();if(3==la){var d=K,c=H;f.moveTo(d,c);f.fillStyle=lb;f.fillRect(d-2,c-2,5,5);for(var b=Pb,a=Math.round(d+hc*Hc*(Pb-Ob[1])),g=Math.round(c+hc*ic*(Pb-Ob[1])),k=0;300>k;k++){f.beginPath();f.lineWidth=1;f.strokeStyle=lb;
f.moveTo(d,c);f.lineTo(a,g);f.stroke();f.beginPath();f.lineWidth=3;f.rect(a-2,g-2,5,5);f.stroke();if(3>a||a+3>N||3>g||g+3>M)break;c=ya+b;c=100*Math.floor(c/60)+c%60;c%=2400;Nd?(d="AM",1200<=c?(1300<=c&&(c-=1200),d="PM"):100>c&&(c+=1200),d=Math.floor(c/100)+":"+Math.floor(Math.floor(c%100)/10)+Math.floor(c%10)+" "+d):(d=c+" ",1E3>c&&(d="0"+c),100>c&&(d="00"+c),10>c&&(d="000"+c));c=0;Math.abs(id)<Qb+5&&(c=45*.0174533);var l=g;0>Ld*id&&0==c&&(l=g+Qb);f.font=lc;var d=d+" "+Md,n=f.measureText(d).width;
f.fillStyle=kc;0===c?(f.fillRect(a+2,l-Qb-2+c,n+4,Qb+3),f.fillStyle=lb,f.textBaseline="bottom",f.fillText(d,a+5,l)):(f.save(),f.translate(a+5,g),f.rotate(c),f.fillRect(2,-2,n+4,Qb+3),f.fillStyle=lb,f.textBaseline="bottom",f.fillText(d,5,Qb),f.restore());d=a;c=g;a=Math.round(d+hc*Ld);g=Math.round(c+hc*id);b+=C}}null!=Ub&&vc(md,we,xe,Ub,0);vc(re,999,10,Id[Ic],0);Hd=Sd;Jd=Td}Rb&&(b=vb*(Nc-oc)/x,a=Qc*(Oc-pc)/B,b=" "+Math.sqrt(b*b+a*a).toFixed(Rd)+" "+Vd+" ",vc(ue,oc/y,pc/E,b,-1),f.beginPath(),f.strokeStyle=
Ud,f.lineWidth=3,f.moveTo(Nc/y,Oc/E),f.lineTo(oc/y,pc/E),f.stroke(),f.closePath());Na&&vc(Wd,wd,xd,vd,-1);if(Sb&&(K=P.getX(),p=K*y,H=P.getY(),v=H*E,0<=p&&0<=v))for(ta=Math.round(D+p/x),ua=Math.round(u+v/B),a=0;a<G;a++)if(Q[w][a].gotit&&F[a].checked&&(a==db||null!=rc[a]&&0<=rc[a])){J.clearRect(0,0,1,1);a==db?J.drawImage(Pa[w],ta,ua,1,1,0,0,1,1):J.drawImage(Q[w][a],ta,ua,1,1,0,0,1,1);z=J.getImageData(0,0,1,1).data;Sc=999;A=rc[a];g=$d;if(0==z[3])g=ge[A];else{if(a==db)ce=0,ob=z[0],Sc=0;else for(b=0;b<
Aa[A].length-1;b++)ab[0]=z[0]-Ba[A][b],0>ab[0]*(Ba[A][b+1]-z[0]-1)||(ab[1]=z[1]-Ca[A][b],0>ab[1]*(Ca[A][b+1]-z[1]-1)||(ab[2]=z[2]-Da[A][b],0>ab[2]*(Da[A][b+1]-z[2]-1)||(Tb=od[A][b],nd=ab[Tb]/zb[A][b][Tb],fe=Math.abs(ab[de[Tb]]-nd*zb[A][b][de[Tb]])+Math.abs(ab[ee[Tb]]-nd*zb[A][b][ee[Tb]]),fe<Sc&&(ob=b,Sc=fe,ce=nd))));if(999>Sc)g=yb[A][ob],-1!=$a[A][ob]&&(g=g+" "+(Aa[A][ob]+ce*(Aa[A][ob+1]-Aa[A][ob])).toFixed($a[A][ob])+" "+xb[A][ob]);else if(1<sc){for(b=0;b<Aa[A].length-1;b++)if(Math.abs(z[0]-Ba[A][b])<
sc&&Math.abs(z[1]-Ca[A][b])<sc&&Math.abs(z[2]-Da[A][b])<sc){g=yb[A][b];-1!=$a[A][b]&&(g=g+" "+Aa[A][b].toFixed($a[A][b])+" "+xb[A][b]);break}W("RGB err: R="+z[0]+" G="+z[1]+" B="+z[2])}}vc(ve,K-10,H,g,1)}!Ra||pa||Ya||Sb||null==L||(f.drawImage(L.can,0,0,L.width,L.height,L.xmin/y,L.ymin/E,L.width/y,L.height/E),vc(Wd,(L.xmin+L.xmax)/2/y,(L.ymin+L.ymax)/2/E,L.tip,0),fd=!0)},qa=function(){var a;if(gd)try{r.clearRect(0,0,N,M);r.globalAlpha=1;if(gc&&null!=Sa&&0<=$&&Sa[$].gotit)r.drawImage(Sa[$],D*wa[$],
u*wa[$],oa*wa[$],Z*wa[$],0,0,N,M);else if(na[w].gotit&&r.drawImage(na[w],D,u,oa,Z,0,0,N,M),null!=ca&&(r.globalAlpha=1,na[w].gotit))for(var b=0;b<ca.length;b+=4)r.drawImage(na[w],ca[b],ca[b+1],ca[b+2],ca[b+3],ca[b],ca[b+1],ca[b+2],ca[b+3]);if(0<G){for(b=0;b<G;b++)a=null!=Ia?Ia[b]:b,F[a].checked&&(gc&&null!=Ta&&0<=$&&Ta[$].gotit&&Fd==a?r.drawImage(Ta[$],D*wa[$],u*wa[$],oa*wa[$],Z*wa[$],0,0,N,M):Q[w][a].gotit&&(null!=yc&&(r.globalAlpha=yc[a]),null==qc||qc[a]?r.drawImage(Q[w][a],D,u,oa,Z,0,0,N,M):r.drawImage(Q[w][a],
0,0,I,S,0,0,N,M)));if(null!=Za)for(r.globalAlpha=1,b=0;b<G;b++)a=null!=Ia?Ia[b]:b,Q[w][a].gotit&&F[a].checked&&Za[a]&&r.drawImage(Q[w][a],U[a][0],U[a][1],U[a][2],U[a][3],U[a][0],U[a][1],U[a][2],U[a][3]);Sb&&Fa()}he&&Yc();if(td){r.globalAlpha=1;var c;for(a=0;a<Qa;a++)c=ub[a],null!=c.icon&&c.icon.gotit&&(c.isPan?r.drawImage(c.icon,0,0,c.width,c.height,((c.x0-D)*x-c.w2)/y,((c.y0-u)*B-c.h2)/E,c.width/y,c.height/E):r.drawImage(c.icon,0,0,c.width,c.height,c.x0/y,c.y0/E,c.width/y,c.height/y))}}catch(e){W("Error:"+
e)}},Yc=function(){if(qd&&Bb>Ha){r.save();r.fillStyle="blue";r.strokeStyle="white";r.lineWidth=3;r.strokeRect(Uc,Vc,200,14);r.fillRect(Uc,Vc,Ha/Bb*200,14);var a=r.measureText("Loading images").width;r.fillStyle="orange";r.font="14px arial";r.fillText("Loading images",Uc+100-a/2,Vc+11);r.restore()}else he=!1},W=function(a){if(La&&pb&&!pb.closed)try{pb.document.write(a+"<br>")}catch(b){}},Fe=function(){cb&&Xc(Gb);qe=w==q-1?yd+ga:ga;qa();setTimeout(function(){Ie(Fe)},qe)}};
