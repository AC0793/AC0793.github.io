function PEvs(W,qd,rd,Db,wc,M,F){var R,J,A,C,Xb,Yb,bb,ba,O,Ka,Eb,pb,La,V,ca,qb,ka,m=0,K=0,Z,e,p=0,T=!1,N=function(e){ba=e.target;for(Ka=O=0;ba;)O+=ba.offsetLeft-ba.scrollLeft,Ka+=ba.offsetTop-ba.scrollTop,ba=ba.offsetParent;m=e.pageX-O-document.body.scrollLeft;K=e.pageY-Ka-document.body.scrollTop};this.getX=function(){return m};this.getY=function(){return K};var da=function(Ea){N(Ea);Z=m;e=K;C=!0;null!=qb&&(Xb=(new Date).getTime());null!=La&&La(Ea)},pa=function(e){N(e);C=!1;null!=pb&&pb(e);null!=
qb&&(Yb=(new Date).getTime(),bb=Yb-Xb,300>bb&&qb(e))},Ha=function(Ea){N(Ea);3>Math.abs(m-Z)&&3>Math.abs(K-e)||(e=Z=-9999,C?null!=V&&V(Ea):null!=ca&&ca(Ea),null!=ka&&qa())};this.touchDown=function(e){A=!0;p+=e.changedTouches.length;if(1<p)return T=!0,e.returnValue=!0;R=e.changedTouches;J=R[0];da(J)};this.touchUp=function(e){A=!0;p-=e.changedTouches.length;0>p&&(p=0);0==p&&(T=!1);if(T)return e.returnValue=!0;e.preventDefault();e.stopImmediatePropagation?e.stopImmediatePropagation():e.stopPropagation();
R=e.changedTouches;J=R[0];pa(J)};this.touchMove=function(e){A=!0;if(T)return e.returnValue=!0;e.preventDefault();e.stopImmediatePropagation?e.stopImmediatePropagation():e.stopPropagation();R=e.changedTouches;J=R[0];Ha(J)};this.mouseDown=function(e){A||(e.preventDefault(),e.stopImmediatePropagation?e.stopImmediatePropagation():e.stopPropagation(),da(e))};this.clearDown=function(){C=!1};this.mouseUp=function(e){A||(e.preventDefault(),e.stopImmediatePropagation?e.stopImmediatePropagation():e.stopPropagation(),
pa(e))};this.mouseClick=function(e){e.preventDefault();e.stopImmediatePropagation?e.stopImmediatePropagation():e.stopPropagation();C=!1};this.mouseMove=function(e){A||(e.preventDefault(),e.stopImmediatePropagation?e.stopImmediatePropagation():e.stopPropagation(),Ha(e))};this.mouseDragged=function(e){A||(e.preventDefault(),e.stopImmediatePropagation?e.stopImmediatePropagation():e.stopPropagation(),N(e),null!=V&&V(e),null!=ka&&qa())};var qa=function(){clearTimeout(Eb);Eb=setTimeout(function(){ka()},
600)};e=Z=K=m=0;La=qd;pb=rd;ca=Db;V=wc;qb=M;ka=F;C=A=!1;W.addEventListener("mousedown",this.mouseDown,!1);W.addEventListener("mouseup",this.mouseUp,!1);W.addEventListener("mousemove",this.mouseMove,!1);W.addEventListener("click",this.mouseClick,!1);W.addEventListener("touchstart",this.touchDown,!1);W.addEventListener("touchend",this.touchUp,!1);W.addEventListener("touchmove",this.touchMove,!1);W.addEventListener("pointerdown",this.mouseDown,!1);W.addEventListener("pointerup",this.mouseUp,!1);W.addEventListener("pointermove",
this.mouseMove,!1);W.addEventListener("contextmenu",function(e){e.preventDefault()},!1);W.addEventListener("touchleave",this.touchUp,!1);W.addEventListener("touchenter",this.touchDown,!1);W.addEventListener("touchcancel",this.touchUp,!1);W.addEventListener("mouseout",function(e){C||(K=m=-1,null!=ca&&ca(e));C=!1})};var HAniS=new function(){function W(a,b,d,f,c){this.color=a;this.alpha=1;7<this.color.length&&(this.alpha=parseInt(this.color.substring(7),16)/255,this.color=this.color.substring(0,7),.1>this.alpha&&(this.alpha=.1));this.action=b;this.value=d;this.tip=f;this.poly=c;a=c.split(",");this.xy=[];this.ymin=this.xmin=9999;for(b=this.ymax=this.xmax=0;b<a.length;b++)this.xy[b]=parseInt(a[b].trim(),10),0==b%2?(this.xy[b]<this.xmin&&(this.xmin=this.xy[b]),this.xy[b]>this.xmax&&(this.xmax=this.xy[b])):(this.xy[b]<
this.ymin&&(this.ymin=this.xy[b]),this.xy[b]>this.ymax&&(this.ymax=this.xy[b]));this.height=this.ymax-this.ymin+1;this.width=this.xmax-this.xmin+1;this.can=l("canvas");this.can.height=this.height;this.can.width=this.width;this.ctx=this.can.getContext("2d");this.ctx.imageSmoothingEnabled=!1;this.ctx.fillStyle=this.color;this.ctx.globalAlpha=this.alpha;this.ctx.beginPath();this.ctx.moveTo(this.xy[0]-this.xmin,this.xy[1]-this.ymin);for(b=2;b<this.xy.length;b+=2)this.ctx.lineTo(this.xy[b]-this.xmin,this.xy[b+
1]-this.ymin);this.ctx.closePath();this.ctx.fill()}function qd(a,b,d,f,c){this.overlay=a;this.color=b;this.action=d;this.value=f;this.tip=c}function rd(a,b,d,f,c,e,h,g,p){this.x0=a;this.y0=b;this.icon=null;this.isIcon=!1;"icon"==d?(this.icon=new Image,this.icon.hotspot=this,sd=!0,this.icon.onload=function(a){this.gotit=!0;this.hotspot.x1=this.hotspot.x0+this.width;this.hotspot.y1=this.hotspot.y0+this.height;this.hotspot.width=this.width;this.hotspot.height=this.height;this.hotspot.w2=this.width/2;
this.hotspot.h2=this.height/2;this.hotspot.isIcon=!0},this.y1=this.x1=-1,this.icon.gotit=!1,this.icon.src=f.trim()):(this.width=parseInt(d,10),this.height=parseInt(f,10),this.x1=this.width+a,this.y1=this.height+b,this.w2=this.width/2,this.h2=this.height/2);this.pan=c;this.isPan=!1;"pan"===this.pan&&(this.isPan=!0);this.action=e;this.value=h;this.overlay=g;this.tip=p}function Db(a,b,d,f,c,e,h){this.bg=a;null!=a&&0==this.bg.indexOf("0x")&&(this.bg="#"+this.bg.substring(2));this.fg=b;null!=b&&0==this.fg.indexOf("0x")&&
(this.fg="#"+this.fg.substring(2));this.font=d;this.fontHeight=Math.round(1.1*parseInt(d,10));this.scolor=f;null!=f&&0==this.scolor.indexOf("0x")&&(this.scolor="#"+this.scolor.substring(2));this.sblur=c;this.sxoff=e;this.syoff=h}var wc,M,F,R,J,A,C,Xb,Yb,bb,ba,O,Ka,Eb,pb,La,V,ca,qb,ka,m,K,Z,e,p,T,N,da,pa,Ha,qa,Ea,G,td,la,P,x,xc,Zb,Na,ud,vd,wd,Fb,H,I,r,s,ra,sa,ma,X,E,B,pe,cb,$b,v,Gb,ac,bc,yc,c,ea,Oa,rb,Yc,xd,qe,Zc,fa,Hb,sb,db,ga,Pa,tb,cc,$c,zc,dc,Ib,Ac,Bc,eb,yd,zd,Ad,Bd,Cd,ub,Qa,sd,ad,Dd,ta,$,y,bd,
ha,ec,Ra,cd,dd,fc,L,ed,fb,Jb,ua,Y,Sa,gb,Ta,Kb,gc,Ua,hb,Ed,Cc,Dc,Ec,Fd,fd,Lb,ia,Mb,Nb,Va,ib,jb,Fc,va,na,ja,Ia,Fa,Ob,Gd,Hd,Id,re,kb,hc,Gc,ic,Jd,jc,gd,Kd,hd,Pb,u,Hc,wa,Ic,Ld,lb,kc,lc,Qb,Md,Nd,mb,Od,mc,D,w,id,Jc,nb,nc,Kc,Wa,Xa,jd,Lc,Pd,xa,Ya,Mc,Nc,Qd,Oc,Rd,se,te,Sd,oc,pc,ue,Td,Rb,vb,Pc,Ud,Vd,aa,qc,Za,S,Qc,Ja,Wd,Xd,Yd,rc,Sb,kd,wb,xb,yb,$a,Tb,Rc,ve,Zd,sc,ld,$d,ae,Ub,we,xe,ob,be,md,ce,de,ab,z,ee,ya,h,zb,za,Aa,Ba,Sc,nd,fe,ye,tc,od,Ab,pd,ge,Tc,Uc,Ga,Bb,Vb,he,Vc,ie,Ge="N NNE NE ENE E ESE SE SSE S SSW SW WSW W WNW NW NNW N".split(" "),
He=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(a,10)},l=function(a){return document.createElement(a)};this.setup=function(a,b){void 0==b&&(b="MORdivcan");V=document.getElementById(b);V.align="center";ca=l("div");ca.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;");
ka=l("canvas");ka.setAttribute("style","position:absolute;top:0;left:0;z-index:1;");Z=l("canvas");Z.setAttribute("style","position:absolute;top:0;left:0;z-index:2;");e=Z.getContext("2d");e.imageSmoothingEnabled=!1;ca.appendChild(ka);ca.appendChild(Z);V.appendChild(ca);O=new PEvs(Z,HAniS.down,HAniS.up,HAniS.move,HAniS.drag,null,HAniS.canTip);V.setAttribute("tabindex",0);V.addEventListener("keydown",function(a){37==a.keyCode?(Ca(!1),Wc(-1),oa()):39==a.keyCode&&(Ca(!1),Wc(1),oa())},!0);v=0;ac=!1;Gb=
1;$b=cb=!0;N=p=0;yc=!0;Ha=null;bc=!0;ea=500;Oa=100;rb=2E3;Yc=30;xd=0;od=6E4;Ab=null;tc=!1;td=Ea=G=null;Jc=id=w=D=1;Kc=!1;B=E=X=ma=sa=ra=s=r=I=H=0;Cc=!1;ta=0;sd=!1;hb=null;Uc=Tc=Ga=Bb=0;Na=ad=fd=!1;Mc=Nc=oc=pc=0;Ra=Pd=Oc=Rb=Ya=!1;Jb=!0;L=fb=null;Sb=kd=ed=!1;ce=[1,0,0];de=[2,2,1];ab=[];rc=[];sb=Hb=na=!1;Ic=Hc=0;var d=l("canvas");d.height=1;d.width=1;K=d.getContext("2d");K.imageSmoothingEnabled=!1;dd=l("canvas");Ka=!1;"string"===typeof a?0>a.indexOf("\n")?Ie(a):je(a.split("\n")):je(a)};var je=function(a){var b,
d,f;Lb=!0;if(a instanceof Array)for(c={},b=0;b<a.length;b++)2>a[b].length||(d=a[b].trim(),0==d.indexOf("#")||0>d.indexOf("=")||(d=d.split("="),f=d[0].trim().toLowerCase(),c[f]=d[1].trim()));else c=a;Ka=!1;null!=c.debug&&("true"==c.debug?(pb=window.open("","HAniSDebugInfo","scrollbars=yes,width=400,height=200"),Ka=!0,U("HAniS Version 2.6")):Ka=!1);U("type of txt = "+(a instanceof Array));Pc=vb=null;null!=c.map_scale&&(Oc=Ya=!0,a=c.map_scale.split(","),vb=parseFloat(a[0]),Pc=1<a.length?parseFloat(a[1]):
vb);Ud=" ";null!=c.distance_unit&&(Ud=c.distance_unit.trim());qb=" ";null!=c.divcan_style&&(qb=c.divcan_style.trim());null!=c.imagecan_style&&(a=c.imagecan_style.trim()+";position:absolute;top:0;left:0;",ka.setAttribute("style",a+"z-index:1;"),Z.setAttribute("style",a+"z-index:2;"));b="blue";d="white";f="12px Arial";var e=null,t=10,l=10,g=10;Qd=1;Td="white";null!=c.distance_display_style&&(a=c.distance_display_style.split(","),b=a[0].trim(),d=a[1].trim(),Td=5<=a.length?a[4].trim():d,f=a[2].trim(),
Qd=parseInt(a[3],10),5<a.length&&(e=a[5].trim(),t=parseInt(a[6],10),l=parseInt(a[7],10),g=parseInt(a[8],10)));ue=new Db(b,d,f,e,t,l,g);b="black";d="white";f="12px Arial";e=null;g=l=t=10;null!=c.probe_display_style&&(a=c.probe_display_style.split(","),b=a[0].trim(),d=a[1].trim(),f=a[2].trim(),3<a.length&&(e=a[3].trim(),t=parseInt(a[4],10),l=parseInt(a[5],10),g=parseInt(a[6],10)));ve=new Db(b,d,f,e,t,l,g);null!=c.pause&&(xd=parseInt(c.pause,10));null!=c.auto_refresh&&(od=6E4*parseInt(c.auto_refresh,
10),Ab=setInterval("HAniS.reloadFOF();",od),tc=!0);Zc=!1;null!=c.enable_smoothing&&(a=c.enable_smoothing.trim().toLowerCase(),"t"==a||"true"==a)&&(Zc=!0);null!=c.overlay_labels&&(pa=c.overlay_labels.split(","));sb=!1;db=-1;null!=c.overlay_enhance&&(sb=!0,db=parseInt(c.overlay_enhance,10)-1);fb=null;Jb=!0;if(null!=c.overlay_allow_hoverzones)for(a=c.overlay_allow_hoverzones.split(","),fb=Array(a.length),b=0;b<a.length;b++)if(fb[b]=!0,0==a[b].trim().toLowerCase().indexOf("n")||0==a[b].trim().toLowerCase().indexOf("f"))fb[b]=
!1;F=M=null;wc=!1;null!=c.window_size&&(a=c.window_size.split(","),F=parseInt(a[0],10),M=parseInt(a[1],10),wc=!0);Fc=null;if(null!=c.overlay_spacer)for(a=c.overlay_spacer.split(","),Fc=Array(a.length),b=0;b<a.length;b++)Fc[b]=parseInt(a[b],10);if(null!=c.overlay_probe_table)for(a=c.overlay_probe_table.split(","),b=0;b<a.length;b++)rc[b]=parseInt(a[b],10)-1;Ha=null;if(null!=c.overlay_order)for(a=c.overlay_order.split(","),Ha=Array(a.length),b=0;b<a.length;b++)Ha[parseInt(a[b],10)-1]=b;qa=null;if(null!=
c.overlay_links)for(a=c.overlay_links.split(","),qa=Array(a.length),b=0;b<a.length;b++)qa[b]=parseInt(a[b],10);Fb=null;if(null!=c.overlay_clear)for(a=c.overlay_clear.split(","),Fb=Array(a.length),b=0;b<a.length;b++)Fb[b]=a[b].trim().toLowerCase();xc=null;if(null!=c.overlay_transparent_amount)for(a=c.overlay_transparent_amount.split(","),xc=Array(a.length),b=0;b<a.length;b++)xc[b]=parseFloat(a[b])/100;qc=null;if(null!=pa&&null!=c.overlay_zoom)for(a=c.overlay_zoom.split(","),qc=Array(a.length),b=0;b<
a.length;b++)if(qc[b]=!0,0==a[b].trim().toLowerCase().indexOf("n")||0==a[b].trim().toLowerCase().indexOf("f"))qc[b]=!1;Za=null;if(null!=pa&&null!=c.overlay_preserve_list)for(a=c.overlay_preserve_list.split(","),Za=Array(a.length),b=0;b<a.length;b++)if(Za[b]=!0,0==a[b].trim().toLowerCase().indexOf("n")||0==a[b].trim().toLowerCase().indexOf("f"))Za[b]=!1;Ic=0;Ld=" ";lb="white";kc="transparent";lc="14pt arial";Md=!1;null!=c.times_label_style&&(a=c.times_label_style.split(","),lb=a[0].trim(),1<a.length&&
(Ic=Math.floor(60*parseFloat(a[1]))),1<a.length&&(Ic="?"==a[1].trim()||"auto"==a[1].trim().toLowerCase()?-Math.floor((new Date).getTimezoneOffset()):Math.floor(60*parseFloat(a[1]))),2<a.length&&(Ld=a[2].trim()),3<a.length&&(kc=a[3].trim()),4<a.length&&(lc=a[4].trim()),5<a.length&&-1!=a[5].trim().indexOf("t")&&(Md=!0));0==lb.indexOf("0x")&&(lb="#"+lb.substring(2));0==kc.indexOf("0x")&&(kc="#"+kc.substring(2));Qb=parseInt(lc,10);re=new Db("black","white",lc,"black",20,5,5);Nd=!1;null!=c.to_from_lock&&
(a=c.to_from_lock.trim(),Nd=0==a.indexOf("t")?!0:!1);b="black";d="white";f="14px arial";e=null;g=l=t=10;$d=ae=" ";ld=Ub=null;null!=c.dirspd_display_style&&(a=c.dirspd_display_style.split(","),b=a[0].trim(),d=a[1].trim(),f=a[2].trim(),$d=a[3],ae=a[4],5<a.length&&(e=a[5].trim(),t=parseInt(a[6],10),l=parseInt(a[7],10),g=parseInt(a[8],10)),ld=new Db(b,d,f,e,t,l,g));b="black";d="white";f="14px arial";e=null;g=l=t=10;null!=c.tipbox_display_style&&(a=c.tipbox_display_style.split(","),b=a[0].trim(),d=a[1].trim(),
f=a[2].trim(),3<a.length&&(e=a[3].trim(),t=parseInt(a[4],10),l=parseInt(a[5],10),g=parseInt(a[6],10)));Vd=new Db(b,d,f,e,t,l,g);S=null;if(null!=pa&&null!=Za)for(a=c.overlay_preserve.split(","),S=Array(Za.length),b=f=0;b<Za.length;b++)if(Za[b]){S[b]=Array(4);for(d=0;4>d;d++)S[b][d]=parseInt(a[f].trim(),10),f+=1;S[b][2]=S[b][2]-S[b][0]+1;S[b][3]=S[b][3]-S[b][1]+1}Ea=null;G=c.image_base;null!=G?Ea=G=G.trim():G=null!=c.image_only_base?c.image_only_base.trim():null;td=G;Lb=!0;if(null!=c.filenames){a=c.filenames.split(",");
p=a.length;T=Array(p);for(b=0;b<p;b++)T[b]=null!=G?G+a[b].trim():a[b].trim();Lb=!1;N=0}if(null!=c.basename){a=c.basename;null!=G&&(a=G+c.basename);d=c.base_starting_number;null==d&&(d=0);p=c.num_frames;null==p&&(p=c.num_images);p=parseInt(p,10);T=Array(p);for(b=0;b<p;b++){f=b+parseInt(d,10);if(0<=a.indexOf("*"))T[b]=a.replace("*",f);else if(0<=a.indexOf("?")){for(e=a;0<=e.lastIndexOf("?");)t=e.lastIndexOf("?"),e=e.substring(0,t)+f%10+e.substring(t+1),f=Math.floor(f/10);T[b]=e}else T[b]=a+b;U("image filename = "+
T[b])}null!=c.reverse_order&&0==c.reverse_order.toLowerCase().indexOf("t")&&T.reverse();Lb=!1;N=0}ad=!0;a=c.background_static;null==a||"f"!=a&&"false"!=a&&"n"!=a||(ad=!1);if(null!=c.overlay_filenames){a=c.overlay_filenames.split(",");da=Array(p);for(b=0;b<a.length;b++)for(f=a[b].split("&"),N=a.length,d=0;d<p;d++)0==b&&(da[d]=Array(N)),da[d][b]=f[d].trim(),null!=G&&(da[d][b]=(G+da[d][b]).trim());Lb=!1}aa=null;if(null!=c.image_preserve)for(a=c.image_preserve.split(","),aa=[],b=0;b<a.length;b++)aa[b]=
parseInt(a[b].trim(),10),1<b%4&&(aa[b]=aa[b]-aa[b-2]+1);Od=!0;null!=c.keep_zoom&&0==c.keep_zoom.trim().toLowerCase().indexOf("f")&&(Od=!1);Vb=he=0;null!=c.hide_bottom&&(he=parseInt(c.hide_bottom.trim(),10));Vc=ie=0;null!=c.hide_top&&(ie=parseInt(c.hide_top.trim(),10));Wd="<div>";Yd=300;Xd=500;null!=c.popup_style&&(a=c.popup_style,Wd='<div style="'+c.popup_style+'">');null!=c.popup_window_size&&(a=c.popup_window_size.split(","),Xd=a[0],Yd=a[1]);nb=!1;null!=c.active_zoom&&0==c.active_zoom.trim().toLowerCase().indexOf("t")&&
(nb=!0);mc=1;null!=c.zoom_scale&&(mc=parseFloat(c.zoom_scale));nc=9999999;null!=c.maximum_zoom&&(nc=parseFloat(c.maximum_zoom));pd=!0;null!=c.use_progress_bar&&0==c.use_progress_bar.trim().toLowerCase().indexOf("f")&&(pd=!1);null!=c.dwell?(a=c.dwell.split(","),ea=parseInt(a[0].trim(),10),1<a.length&&(Oa=parseInt(a[1].trim(),10),10>Oa&&(Oa=10),rb=parseInt(a[2].trim(),10),Yc=parseInt(a[3].trim(),10))):null!=c.rate&&(a=c.rate.split(","),ea=Math.round(1E4/parseFloat(a[0].trim())),1<a.length&&(Oa=Math.round(1E4/
parseFloat(a[2].trim())),10>Oa&&(Oa=10),rb=Math.round(1E4/parseFloat(a[1].trim()))));kb=null;if(null!=c.times){a=c.times.split(",");kb=Array(a.length);for(b=0;b<a.length;b++)kb[b]=parseInt(a[b].trim(),10);ze(kb)}jc=null;null!=c.extrap_times_template&&(jc=RegExp(c.extrap_times_template));Hd=["Click on target's initial position","Click on target's final position","Move pointer around or click here to select target"];null!=c.extrap_prompts&&(Hd=c.extrap_prompts.split(","));if(null!=c.probe_table){a=
new XMLHttpRequest;ya=[];fe=[];xb=[];var m=" ";yb=[];var Ma="Value=";$a=[];var n=1;zb=[];nd=[];za=[];Aa=[];Ba=[];var q,k=-1;h=-1;var r=0;a.onload=function(){for(var a=this.responseText.split("\n"),b=0;b<a.length;b++)if(!(2>a[b].length)){var d=a[b].replace(/\s+/g," ").trim().split(","),f=d[0].split(" ");if(0==f[0].indexOf("*"))h++,ya[h]=[],yb[h]=[],xb[h]=[],$a[h]=[],za[h]=[],Aa[h]=[],Ba[h]=[],nd[h]=[],zb[h]=[],k=-1,fe[h]=1<d.length?d[1].trim():"None",r=1;else if(0!=r){k++;var c=Array(3);ya[h][k]=parseFloat(f[0]);
za[h][k]=parseInt(f[1].trim(),10);Aa[h][k]=parseInt(f[2].trim(),10);Ba[h][k]=parseInt(f[3].trim(),10);0!=k&&(c[0]=za[h][k]-za[h][k-1],c[1]=Aa[h][k]-Aa[h][k-1],c[2]=Ba[h][k]-Ba[h][k-1],q=0,Math.abs(c[1])>Math.abs(c[q])&&(q=1),Math.abs(c[2])>Math.abs(c[q])&&(q=2),nd[h][k-1]=q,zb[h][k-1]=c,0==zb[h][k-1][q]&&(zb[h][k-1][q]=1));1<d.length&&(0==d[1].trim().indexOf('"')?(n=-1,d=d[1].trim(),Ma=d.substr(1,d.length-2),m=""):(n=parseInt(d[1],10),2<d.length&&(m=d[2].trim()),3<d.length&&(Ma=d[3].trim())));yb[h][k]=
Ma;$a[h][k]=n;xb[h][k]=m}}};a.open("get",c.probe_table,!0);a.send()}Xb=c.controls;U("controls = "+c.controls);U("bottom_controls = "+c.bottom_controls);Ja=Qc=jb=ib=Nb=Mb=ia=null;null!=Xb&&Ae(Xb,!0);Yb=c.bottom_controls;null!=Yb&&Ae(Yb,!1);Lb?HAniS.getFOF():(bc=!0,ke())},Ie=function(a){var b=new XMLHttpRequest;b.onload=function(){je(this.responseText.split("\n"))};b.open("get",a+"?"+Math.round(1E5*Math.random()),!0);b.send()},Be=function(a){var b;if(null!=Fb){for(b=0;b<Fb.length;b++)-1!=Fb[b].indexOf(a)&&
(x[b].checked=!1);for(b=0;b<Fb.length;b++)le(b)}},ze=function(a){var b=0;gd=Array(a.length);for(var d=0;d<a.length;d++){var f=60*Math.floor(a[d]/100)+Math.floor(a[d])%100;0==d&&(wa=f);b=f-wa;0>b&&(b=f+1440-wa);gd[d]=b;U("times s="+f+"  min="+gd[d])}wa+=Ic;1440<=wa&&(wa-=1440);0>wa&&(wa+=1440);U("Starting minute = "+wa)},Ce=function(a,b){if(0!=a)for(var d=0;d<a;d++)0==x[$[d].overlay].isGhost&&(x[$[d].overlay].parentNode.style.visibility=b)};this.reloadFOF=function(){U("reload FoF = "+Ab);Be("r");Lb?
HAniS.newFOF(ye):(bc=!0,ke())};this.getFOF=function(){var a=c.file_of_filenames.trim();HAniS.newFOF(null!=Ea?Ea+a:a)};this.newFOF=function(a){var b,d,f,c,e,h=new XMLHttpRequest,g,l,Ma,n,q,k;Dd=ta;var m=null;fd=!1;$b=cb;Ca(!1);ta=p=0;T=[];ub=null;Qa=0;ha=null;ec=0;Ra=cd=!1;ua=null;gc=!1;Y=-1;Kb=Ta=gb=Sa=null;Ed=-1;da=[];var r=!1;if(null==kb||null!=jc)kb=[];U("new FOF="+a);na&&(null!=va&&(va.innerHTML=va.label_on,V.style.cursor="default",Ca($b),ja=-1),na=!1,Da());h.onload=function(){var a=this.responseText.split("\n");
for(b=0;b<a.length;b++)if(!(2>a[b].length)&&(g=a[b].trim(),U("FOF: "+g),0!=g.indexOf("#")))if(0==g.indexOf("fof_extension"))q=g.split("="),m=q[1].trim();else if(0==g.indexOf("image_base"))q=g.split("="),G=q[1].trim();else if(0==g.indexOf("high_res_basemap")){q=g.split("=");k=q[1].split(",");gb=[];for(d=0;d<k.length;d++)gb[d]=k[d].trim(),null!=G&&(gb[d]=G+gb[d]);gc=!0}else if(0==g.indexOf("high_res_overlay")){q=g.split("=");k=q[1].split(",");Ed=parseInt(k[0].trim(),10)-1;Kb=[];for(d=1;d<k.length;d++)Kb[d-
1]=k[d].trim(),null!=G&&(Kb[d-1]=G+Kb[d-1]);gc=!0}else if(0==g.indexOf("high_res_zoom")){q=g.split("=");k=q[1].split(",");ua=[];for(d=0;d<k.length;d++)ua[d]=parseFloat(k[d].trim());me()}else if(0==g.indexOf("hoverzone"))Je(g);else if(0==g.indexOf("hotzone"))De(g);else if(0==g.indexOf("hotspot"))Ke(g);else if(0==g.indexOf("toggle_onoff")&&(q=g.split("="),Dc=q[1].split(",")),0==g.indexOf("map_scale"))q=g.split("="),k=q[1].split(","),vb=parseFloat(k[0]),Pc=1<k.length?parseFloat(k[1]):vb;else if(0==g.indexOf("times")){q=
g.split("=");k=q[1].split(",");for(b=0;b<k.length;b++)kb[b]=parseInt(k[b].trim(),10);r=!0}else{if(null!=jc){var h=g.match(jc);null!=h&&2==h.length?(kb.push(parseInt(h[1],10)),U("+ + + Extrap time = "+h[1]),r=!0):U("+ + + Cannot parse times using "+jc+" from line: "+g)}f=g.indexOf(" ");0>f&&(f=g.length);T[p]=g.substring(0,f).trim();null!=G&&(T[p]=G+T[p]);g=g.substring(f+1);c=g.indexOf('"');0<=c&&(null==Ua&&(Ua=[]),f=g.substring(c+1),c=f.indexOf('"'),0<=c&&(Ua[p]=f.substring(0,c),0==p&&(hb.innerHTML=
Ua[0])));da[p]=[];c=g.indexOf("overlay");if(0<=c)for(l=g.substring(c),c=l.indexOf("="),0>c&&U("Cannot find a = sign in "+l),Ma=l.substring(c+1),l=Ma.trim(),Ma=l.split(","),N=Ma.length,U("numOverlays set to "+N),e=0;e<Ma.length;e++)da[p][e]=Ma[e].trim(),null!=G&&(da[p][e]=(G+da[p][e]).trim());p+=1}r&&ze(kb);null!=m?(a=new XMLHttpRequest,a.onload=function(){var a=this.responseText.split("\n");for(b=0;b<a.length;b++)2>a[b].length||(n=a[b].trim(),U("ext_FOF: "+n),0!=n.indexOf("#")&&0==n.indexOf("hotzone")&&
De(n));ne()},a.onerror=function(){ne()},a.open("get",m+"?"+Math.round(1E5*Math.random()),!0),a.send()):ne()};ye=a;h.open("get",a+"?"+Math.round(1E5*Math.random()),!0);h.send()};var ne=function(){0!=ta?Ce(ta,"visible"):0!=Dd&&Ce(Dd,"hidden");bc=!0;ke()},ke=function(){var a,b,d,f="?"+Math.round(1E4*Math.random());la=Array(p);Bb=Ga=0;ge=pd;Pd&&(Xa.max=p-1);yc&&(Hb||sb)&&(Pa=[],ga=[],tb=[],$c=[],zc=[]);null!=fa&&(fa.selectedIndex=0);for(a=0;a<p;a++){yc&&(Hb||sb)&&(Pa[a]=l("canvas"),ga[a]=l("canvas"));
la[a]=new Image;la[a].gotit=!1;la[a].frameNum=a;la[a].onerror=function(){Ga++};la[a].onload=function(){yc&&(yc=!1,R=this.height,J=this.width,X=R,ma=J,wc?(ka.height=M,ka.width=F,Z.height=M,Z.width=F):(ka.height=X,ka.width=ma,Z.height=X,F=Z.width=ma,M=X),Tc=F/2-100,Uc=M/2-10,A=1*ma/F,C=1*X/M,ca.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;"+
qb+"height:"+M+"px;width:"+F+"px;"));if(0<ec&&!cd){dd.height=R;dd.width=J;fc=dd.getContext("2d");fc.clearRect(0,0,F,M);for(var a=0;a<ha.length;a++){for(var c=ha[a].ctx.getImageData(0,0,ha[a].width,ha[a].height).data,g=fc.getImageData(ha[a].xmin,ha[a].ymin,ha[a].width,ha[a].height),h=3;h<c.length;h+=4)0!=c[h]&&(g.data[h]=a+1);fc.putImageData(g,ha[a].xmin,ha[a].ymin)}nb||(Ra=!0);cd=!0}if(bc){bc=!1;m=ka.getContext("2d");m.imageSmoothingEnabled=Zc;m.fillStyle="blue";m.font="bold 20px Arial";e=Z.getContext("2d");
e.imageSmoothingEnabled=Zc;dc=Array(p);Cc&&Le(p);if(0<N)for(P=Array(p),d=0;d<p;d++)for(P[d]=Array(N),b=0;b<N;b++)P[d][b]=new Image,P[d][b].gotit=!1,P[d][b].frameNum=d,P[d][b].overlayNum=b,P[d][b].onerror=function(){Ga++},P[d][b].onload=function(){this.gotit=!0;Ga++;Xc();if(this.height!=R||this.width!=J)this.gotit=!1,U("Bad image size:"+this.src);if(sb&&this.gotit&&this.overlayNum==db){var a=this.frameNum;Pa[a].height=this.height;Pa[a].width=this.width;cc=Pa[a].getContext("2d");cc.drawImage(this,0,
0);$c[a]=cc.getImageData(0,0,this.width,this.height).data;ga[a].height=this.height;ga[a].width=this.width;tb[a]=ga[a].getContext("2d");tb[a].drawImage(this,0,0);zc[a]=tb[a].getImageData(0,0,this.width,this.height);P[a][this.overlayNum]=null;P[a][this.overlayNum]=ga[a];P[a][this.overlayNum].gotit=!0}},a=da[d][b],void 0==Zb||Zb[b]||(a=da[d][b]+f),P[d][b].src=a,Bb++;if(null!=gb)for(Sa=[],b=0;b<gb.length;b++)Sa[b]=new Image,Sa[b].gotit=!1,Sa[b].onerror=function(a){Ga++},Sa[b].onload=function(a){a.currentTarget.gotit=
!0;Ga++;Xc()},Sa[b].src=gb[b],Bb++;if(null!=Kb)for(Ta=[],b=0;b<gb.length;b++)Ta[b]=new Image,Ta[b].gotit=!1,Ta[b].onerror=function(a){Ga++},Ta[b].onload=function(a){a.currentTarget.gotit=!0;Ga++;Xc()},Ta[b].src=Kb[b],Bb++}this.height==R&&this.width==J?this.gotit=!0:(this.gotit=!1,U("Image has invalid size:"+this.src));Hb&&this.gotit&&(a=this.frameNum,Pa[a].height=this.height,Pa[a].width=this.width,cc=Pa[a].getContext("2d"),cc.drawImage(this,0,0),$c[a]=cc.getImageData(0,0,this.width,this.height).data,
ga[a].height=this.height,ga[a].width=this.width,tb[a]=ga[a].getContext("2d"),tb[a].drawImage(this,0,0),zc[a]=tb[a].getImageData(0,0,this.width,this.height),la[a]=null,la[a]=ga[a],la[a].gotit=!0);Ga++;Xc();pe||(pe=!0,Ca(!0),Ee());Ca($b);Od||HAniS.resetZoom();fd=!0};var c=T[a];ad||(c=T[a]+f);la[a].src=c;Bb++}Rb=Na=!1;Da()},Cb=function(a,b,d,f,e){a.label_on=d;a.label_off=f;d=null;f=c[b+"_labels"];null==f&&(f=c[b+"_label"]);null!=f&&(f=f.split(","),a.label_on=f[0].trim(),1<f.length&&(a.label_off=f[1].trim()),
2<f.length&&(d="width:"+f[2].trim()+"px;"));null!=e&&(a.title=e);a.innerHTML=a.label_on;b=(null!=d?d:"")+La+c[b+"_style"];null!=b&&a.setAttribute("style",b)},Ae=function(a,b){var d,f,e,t;La=c.buttons_style;var m=null,g=null,m=b?c.controls_tooltip:c.bottom_controls_tooltip,r=a.split(",");null!=m&&(e=m.split(","),e.length!=r.length&&(U("!!! Number of tooltips must equal number of controls!"),e=m=null));var s=null,n;for(d=0;d<r.length;d++){n=null!=m?e[d]:null;var q=r[d].trim(),k=q.indexOf("/");if(0===
k||0===d)0===k&&(q=q.substring(1)),t=l("div"),t.align="center",null!=c.controls_style?t.setAttribute("style",c.controls_style):t.setAttribute("style","position:relative;padding:2px;width:100%;"),b?V.insertBefore(t,ca):(null!=c.bottom_controls_style&&t.setAttribute("style",c.bottom_controls_style),V.appendChild(t));k=c.enhance_filename;null==k&&(k=c.enhance_table);if("enhance"==q.trim()&&null!=k){fa=l("select");g=c.enhance_style;null!=g&&fa.setAttribute("style",g);null!=n&&(fa.title=n);g=l("option");
g.innerHTML="Pick Enhancement";g.value=-1;fa.add(g);fa.addEventListener("change",HAniS.doEnhance,!1);Hb=!sb;fa.disabled=Hb?!1:!0;t.appendChild(fa);g=new XMLHttpRequest;ya=[];xb=[];yb=[];$a=[];var A,y,z;za=[];Aa=[];Ba=[];Sc=[];h=-1;var B=!1,u,D,w,C,E,F,N,G,O,M,P,L,R;g.onload=function(){for(var a=this.responseText.split("\n"),b=0;b<a.length;b++)if(!(2>a[b].length)){var d=a[b].replace(/\s+/g," ").trim(),f=d.indexOf("#");if(0!=f)if(0<f&&(d=d.substring(0,f)),0==d.indexOf("*"))h++,ya[h]=Array(256),yb[h]=
Array(256),xb[h]=Array(256),$a[h]=Array(256),za[h]=Array(256),Aa[h]=Array(256),Ba[h]=Array(256),Sc[h]=Array(256),ya[h]=Array(256),A=" ",y="Value =",z=1,f=l("option"),f.innerHTML=d.substring(1),f.value=h,fa.add(f);else{var c=d.indexOf("value");0>c&&(c=d.indexOf("probe"));B=!1;M=P=0;0<c&&(f=d.substring(c+1),d=d.substring(0,c),c=f.indexOf("="),f=f.substring(c+1),f=f.split(","),1==f.length?(y=f[0].trim(),z=-1,B=!1):(M=parseFloat(f[0].trim()),P=parseFloat(f[1].trim()),2<f.length&&(z=parseInt(f[2],10)),
3<f.length&&(A=f[3].trim()),4<f.length&&(y=f[4].trim()),B=!0));d=d.split(" ");u=parseInt(d[0].trim(),10);D=parseInt(d[1].trim(),10);w=D-u;C=parseFloat(d[2].trim());E=parseFloat(d[3].trim());F=parseFloat(d[4].trim());N=parseFloat(d[5].trim());G=parseFloat(d[6].trim());O=parseFloat(d[7].trim());L=R=255;9<d.length&&(L=parseFloat(d[8].trim()),R=parseFloat(d[9].trim()));for(d=u;d<=D;d++)0==w?(za[h][u]=C,Aa[h][u]=F,Ba[h][u]=G,Sc[h][u]=L):(za[h][d]=Math.round(C+(E-C)*(d-u)/w),Aa[h][d]=Math.round(F+(N-F)*
(d-u)/w),Ba[h][d]=Math.round(G+(O-G)*(d-u)/w),Sc[h][d]=Math.round(L+(R-L)*(d-u)/w)),yb[h][d]=y,xb[h][d]=A,$a[h][d]=z,B&&(ya[h][d]=M+(P-M)*(d-u)/w)}}};g.open("get",k,!0);g.send()}"startstop"==q&&(ia=l("button"),Cb(ia,"startstop","Start","Stop",n),ia.addEventListener("click",HAniS.toggleIsLooping,!1),t.appendChild(ia));"looprock"==q&&(Wa=l("button"),Cb(Wa,"looprock","Rock","Loop",n),Gb=1,Wa.addEventListener("click",HAniS.toggleLoopRock,!1),t.appendChild(Wa));"extrap"==q&&(va=l("button"),Cb(va,"extrap",
"Enable Extrap","Disable Extrap",n),va.addEventListener("click",HAniS.toggleExtrap,!1),t.appendChild(va));"distance"==q&&(xa=l("button"),Cb(xa,"distance","Show dist","Hide dist",n),Ya=Oc=!1,xa.addEventListener("click",function(){Ya=!Ya;xa.innerHTML=Ya?xa.label_off:xa.label_on},!1),t.appendChild(xa));"probe"==q&&(wb=l("button"),Cb(wb,"probe","Show probe","Hide probe",n),Sb=kd=!1,Zd="Undefined",sc=0,null!=c.probe_undefined&&(k=c.probe_undefined.split(","),Zd=k[0].trim(),1<k.length&&(sc=parseInt(k[1],
10)+1)),wb.addEventListener("click",function(){(kd=!kd)?(wb.innerHTML=wb.label_off,Sb=!0):(wb.innerHTML=wb.label_on,Sb=!1)},!1),t.appendChild(wb));"refresh"==q&&(Qc=l("button"),Cb(Qc,"refresh","Refresh",null,n),Qc.addEventListener("click",HAniS.reloadFOF,!1),t.appendChild(Qc));"setframe"==q&&(Xa=l("input"),Xa.type="range",Xa.min=0,Xa.max=99,Xa.value=0,jd="Frame #*",null!=c.setframe_label&&(jd=c.setframe_label),Lc=l("span"),Lc.innerHTML=jd.replace("*",1),g="display:block;vertical-align:middle;"+c.setframe_style,
Xa.setAttribute("style",g),k=l("span"),k.setAttribute("style","display:inline-block;vertical-align:top;"),Lc.setAttribute("style","display:block;vertical-align:middle;"+c.setframe_label_style),k.appendChild(Lc),k.appendChild(Xa),t.appendChild(k),Xa.addEventListener("input",function(a){Ca(!1);uc(parseInt(Xa.value,10));Lc.innerHTML=jd.replace("*",v+1);oa()},!1),Pd=!0);"framelabel"==q&&(hb=l("button"),hb.innerHTML="",Ua=null,null!=c.frame_labels&&(Ua=c.frame_labels.split(","),hb.innerHTML=Ua[0]),g=La+
c.framelabel_style,null!=g&&hb.setAttribute("style",g),t.appendChild(hb));if("autorefresh"==q||"autorefresh/off"==q)null!=Ab&&clearInterval(Ab),Ja=l("button"),Cb(Ja,"autorefresh","Disable Auto Refresh","Enable Auto Refresh",n),Ja.addEventListener("click",HAniS.toggleAutoRefresh,!1),tc=!1,t.appendChild(Ja),"autorefresh"==q?HAniS.toggleAutoRefresh():Ja.innerHTML=Ja.label_off;"step"==q&&(k=c.step_labels,k=null!=k?k.split(","):["<",">"],Nb=l("button"),Nb.innerHTML=k[0],Nb.addEventListener("click",function(){Ca(!1);
Wc(-1);oa()},!1),g=La+c.step_style,null!=g&&Nb.setAttribute("style",g),null!=n&&(Nb.title=n),t.appendChild(Nb),Mb=l("button"),Mb.innerHTML=k[1],Mb.addEventListener("click",function(){Ca(!1);Wc(1);oa()},!1),null!=g&&Mb.setAttribute("style",g),null!=n&&(Mb.title=n),t.appendChild(Mb));"firstlast"==q&&(k=c.firstlast_labels,k=null!=k?k.split(","):["<<",">>"],bb=l("button"),bb.innerHTML=k[0],bb.addEventListener("click",function(){Ca(!1);uc(0);oa()},!1),g=La+c.firstlast_style,null!=g&&bb.setAttribute("style",
g),null!=n&&(bb.title=n),t.appendChild(bb),ba=l("button"),ba.innerHTML=k[1],ba.addEventListener("click",function(){Ca(!1);uc(p-1);oa()},!1),null!=g&&ba.setAttribute("style",g),null!=n&&(ba.title=n),t.appendChild(ba));"setspeed"==q?(Va=l("input"),Va.type="range",Va.min=Oa,Va.max=rb,Va.value=rb-ea,null!=n&&(Va.title=n),g="vertical-align:middle;"+c.setspeed_style,Va.setAttribute("style",g),Va.addEventListener("input",function(a){ea=rb-parseInt(Va.value,10)+30;Ca(!0);oa()},!1),t.appendChild(Va)):"speed"==
q&&(k=c.speed_labels,k=null!=k?k.split(","):["-","+"],jb=l("button"),jb.innerHTML=k[0],jb.addEventListener("click",function(){ea+=Yc;ib.disabled=!1;ea>rb&&(ea=rb,jb.disabled=!0)},!1),g=La+c.speed_style,null!=g&&jb.setAttribute("style",g),null!=n&&(jb.title=n),t.appendChild(jb),ib=l("button"),ib.innerHTML=k[1],ib.addEventListener("click",function(){ea-=Yc;jb.disabled=!1;ea<Oa&&(ea=Oa,ib.disabled=!0)},!1),null!=g&&ib.setAttribute("style",g),null!=n&&(ib.title=n),t.appendChild(ib));"zoom"==q&&(mb=l("button"),
Cb(mb,"zoom","Zoom","Un-zoom",n),mb.addEventListener("click",HAniS.toggleZooming,!1),t.appendChild(mb));"toggle"==q&&(dc=[],k=c.toggle_size,null!=k?(k=k.split(","),Ib=parseInt(k[0],10),Ac=parseInt(k[1],10),Bc=parseInt(k[2],10)):(Ac=Ib=10,Bc=3),Ad="red",Bd="blue",Cd="orange",k=c.toggle_colors,null!=k&&(k=k.split(","),Bd=k[0].trim(),Ad=k[1].trim(),Cd=k[2].trim()),eb=l("div"),eb.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;"),
eb.style.backgroundColor=t.style.backgroundColor,eb.align="center",zd=new PEvs(eb,null,null,null,null,HAniS.togclick,null),Ec=l("canvas"),Ec.height=2*Ac,Fd=Ec.getContext("2d"),eb.appendChild(Ec),b?V.insertBefore(eb,ca):V.appendChild(eb),k=c.toggle_onoff,Dc=null,null!=k&&(Dc=k.split(",")),Cc=!0,null!=n&&(eb.title=n));if("overlay"==q){x=[];q=c.overlay_tooltip;n=null;null!=q&&(n=q.split(","));q=c.overlay_radio;k=null;null!=q&&(k=q.split(","));var K=c.overlay_labels_color,g=null;null!=K&&(g=K.split(","));
Zb=[];f=c.overlay_caching;K=null;null==f&&(f=c.overlay_static);null!=f&&(K=f.split(","));var T=!0;null!=c.overlay_nonewdiv&&(T=!1);for(f=0;f<pa.length;f++){var Q=pa[f].trim();if(0==f||0==Q.indexOf("/"))0==Q.indexOf("/")&&(Q=Q.substr(1)),T?(s=l("div"),s.align="center",b?V.insertBefore(s,ca):V.appendChild(s)):(s=l("span"),t.appendChild(s)),null!=c.overlay_labels_style&&s.setAttribute("style",c.overlay_labels_style);var H=!1,I=Q.length;0<Q.indexOf("/on")&&Q.indexOf("/on")==I-3&&(H=!0,Q=Q.substr(0,I-
3));var J=!1;0<Q.indexOf("/always")&&Q.indexOf("/always")==I-7&&(J=H=!0);var S=!1;0<Q.indexOf("/hidden")&&Q.indexOf("/hidden")==I-7&&(S=!0);null!=K?"y"==K[f].trim().toLowerCase()||"t"==K[f].trim().toLowerCase()?Zb[f]=!0:Zb[f]=!1:Zb[f]=!0;x[f]=l("input");x[f].type="checkbox";x[f].value=Q;I="vertical-align:middle;";null!=c.checkbox_style&&(I+=c.checkbox_style);x[f].setAttribute("style",I);x[f].checked=H;x[f].name=0;null!=fa&&f==db&&x[f].checked&&(fa.disabled=!1);null!=fb&&!fb[f]&&H&&(Jb=!1);x[f].addEventListener("click",
HAniS.overClick,!1);null!=q&&(H=k[f].indexOf("/"),-1!=H&&(x[f].name=k[f].substr(H+1).trim()),-1!=k[f].indexOf("true")&&(x[f].type="radio",-1==H&&(x[f].name="all")));x[f].isGhost=!0;J||S||(null!=n&&(x[f].title=n[f]),J=l("label"),J.htmlFor=Q,null!=n&&(J.title=n[f]),J.appendChild(document.createTextNode(Q)),Q="vertical-align:middle;",null!=g&&(Q=Q+"color:"+g[f]+";"),J.setAttribute("style",Q),Q=l("span"),S="10",null!=Fc&&(S=10+Fc[f]),Q.setAttribute("style","margin-left:"+S+"px;"),Q.appendChild(x[f]),
Q.appendChild(J),s.appendChild(Q),x[f].isGhost=!1)}if(null==qa)for(qa=Array(pa.length),f=0;f<pa.length;f++)qa[f]=0;else for(f=0;f<pa.length;f++)le(f)}}},le=function(a){var b,d;if(0>qa[a]){d=!1;for(b=0;b<pa.length;b++)qa[b]!=-qa[a]||d||(d=x[b].checked);x[a].checked=d}},Ke=function(a){0==Qa&&(ub=[]);a=a.split("=")[1].split(",");var b=a[4].trim(),d=a[4].indexOf("/"),f=-1;-1!=d&&(f=parseInt(a[4].substring(d+1),10)-1,b=b.substring(0,d));ub[Qa]=new rd(parseInt(a[0].trim(),10),parseInt(a[1].trim(),10),a[2].trim(),
a[3].trim(),b.toLowerCase(),a[5].trim().toLowerCase(),a[6].trim(),f,8==a.length?a[7].trim():null);Qa+=1},Je=function(a){0==ec&&(ha=[],L=null);var b=a.split("=")[1].split("(");a=b[0].split(",");var d=a[0].trim();0==d.indexOf("0x")&&(d="#"+d.substring(2));ha[ec]=new W(d,a[1].trim(),a[2].trim(),a[3].trim(),b[1].trim());ec+=1},De=function(a){0==ta&&($=[]);a=a.split("=")[1].split(",");$[ta]=new qd(parseInt(a[0],10)-1,parseInt(a[1],16),a[2].trim(),a[3].trim(),5==a.length?a[4].trim():"Click for details");
ta+=1};this.drag=function(a){H=O.getX();I=O.getY();r=H*A;s=I*C;Rb=Na=!1;Ya&&(!Oc||Oc&&a.shiftKey)?(oc=r,pc=s,Rb=!0):(nb&&w!=Jc?(E=(ra*D-r)/D,B=(sa*w-s)/w,0>E&&(E=0),B<Vc&&(B=Vc),E+ma>J&&(E=J-ma),B+X>R-Vb&&(B=R-Vb-X),E=Math.round(E),B=Math.round(B),ra=Math.round(E+r/D),sa=Math.round(B+s/w)):!na&&Ra&&(L=null,Jb&&0<=r&&0<=s&&(y=fc.getImageData(r,s,1,1).data,0!=y[3]&&(L=ha[y[3]-1]))),Kc=!0,oa());Da()};var me=function(){if(gc){Y=-1;for(var a=0;a<ua.length;a++)D>=ua[a]&&(Y=a)}},oe=function(a,b){"popup"==
a.action?(null!=Eb&&Eb.close(),Eb=window.open("","HAniSPopup","scrollbars=yes,width="+Xd+",height="+Yd),Eb.document.write(Wd+a.value+"</div>")):"link"==a.action?window.open(a.value,"_blank",""):"fof"==a.action&&(G=td,HAniS.resetZoom(),HAniS.newFOF(a.value),Be(b))};this.resetZoom=function(){D=id;w=Jc;null!=mb&&(mb.innerHTML=mb.label_on,nb=!1);ra=r;sa=s;B=E=0;X=R;ma=J;me();oa();cd&&(Ra=!0)};this.canTip=function(){var a;Na=!1;H=O.getX();r=H*A;I=O.getY();s=I*C;if(!(na&&s<Id&&r>Gd)){ra=Math.round(E+r/
D);sa=Math.round(B+s/w);if(0!=ta)for(a=0;a<ta;a++)if($[a].overlay>=N)U(" Error...hotzone overlay # "+$[a].overlay+" > number of overlays = "+N);else if(x[$[a].overlay].checked&&(K.clearRect(0,0,1,1),K.drawImage(P[v][$[a].overlay],ra,sa,1,1,0,0,1,1),y=K.getImageData(0,0,1,1).data,bd=(y[0]<<16)+(y[1]<<8)+y[2],bd==$[a].color)){Na=!0;vd=H;wd=I;ud=$[a].tip;break}if(0!=Qa){var b,d,f,c;for(a=0;a<Qa;a++)if(c=ub[a],-1==c.overlay||x[c.overlay].checked)if(f=!1,c.isPan?c.isIcon?(b=(c.x0-E)*D-c.w2,d=(c.y0-B)*
w-c.h2,r>b&&r<b+c.width&&s>d&&s<d+c.height&&(f=!0)):(b=(c.x0-E)*D,d=(c.y0-B)*w,r>b&&r<b+c.width*D&&s>d&&s<d+c.height*w&&(f=!0)):r>c.x0&&r<c.x1&&s>c.y0&&s<c.y1&&(f=!0),f&&null!=c.tip){Na=!0;vd=H;wd=I;ud=ub[a].tip;break}}Da()}};this.move=function(){if(!na&&Ra&&(L=null,Jb)){var a=O.getX()*A,b=O.getY()*C;0<=a&&0<=b&&(y=fc.getImageData(a,b,1,1).data,0!=y[3]&&(L=ha[y[3]-1]))}na&&2<=ja&&(H=O.getX(),r=H*A,I=O.getY(),s=I*C);Da()};this.down=function(){Na&&(Na=!1,Da());H=O.getX();r=H*A;I=O.getY();s=I*C;Mc=r;
Nc=s;oc=Mc;pc=Nc;ra=Math.round(E+r/D);sa=Math.round(B+s/w);Kc=!1};this.up=function(a){Na=!1;if(na){H=O.getX();r=H*A;I=O.getY();s=I*C;if(3>ja)if(Ia[ja]=r,Fa[ja]=s,Ob[ja]=gd[v],0==ja)ja=1,uc(p-1),Hc=1,Ub=null;else{Jd=Ob[1]-Ob[0];Gc=(Ia[1]-Ia[0])/Jd;ic=(Fa[1]-Fa[0])/Jd;if(null!=ld&&null!=vb){var b=Gc*vb,d=ic*Pc,f=Math.round(60*Math.sqrt(b*b+d*d)),b=Math.atan2(b,-d)/.0174533;0>b&&(b+=360);Ub=$d+Ge[Math.round(b/22.5)]+" at "+f+" "+ae;we=Ia[0];xe=0<ic?Fa[0]-15:Fa[0]+30}f=parseInt(lc,10);u=Math.round(Math.abs(4*
(f+4)/Gc));Pb=Math.round(Math.abs(2*(f+4)/ic));Pb<u&&(u=Pb);120<u?u=120*Math.floor(u/120)+60:90<u?u=120:60<u?u=90:30<u?u=60:15<u?u=30:10<u?u=15:5<u?u=10:2<u?u=5:0==u&&(u=1);Pb=Ob[1]/u*u+u;hc=1;Nd&&(hc=-1);Kd=Gc*u;hd=ic*u;uc(p-1);ja=3;Hc=2}else if(s<Id&&r>Gd&&3==ja){Fe();Da();return}Da()}if(Rb)Rb=!1,Da();else if(null!=xa&&nb&&(Ya=!1,xa.innerHTML=xa.label_on),Kc)Kc=!1;else if(a.altKey)HAniS.resetZoom();else if(Ra&&null!=L&&ed)oe(L,"z");else{H=O.getX();r=H*A;I=O.getY();s=I*C;if(0!=ta)for(f=0;f<ta;f++)if($[f].overlay>=
N)U(" Error...hotzone overlay # "+$[f].overlay+" > number of overlays = "+N);else if(x[$[f].overlay].checked&&(K.clearRect(0,0,1,1),K.drawImage(P[v][$[f].overlay],Math.floor(ra),Math.floor(sa),1,1,0,0,1,1),y=K.getImageData(0,0,1,1).data,bd=(y[0]<<16)+(y[1]<<8)+y[2],bd==$[f].color)){oe($[f],"z");return}if(0!=Qa)for(var c,e,f=0;f<Qa;f++)if(e=ub[f],-1==e.overlay||x[e.overlay].checked)if(c=!1,e.isPan?e.isIcon?(b=(e.x0-E)*D-e.w2,d=(e.y0-B)*w-e.h2,r>b&&r<b+e.width&&s>d&&s<d+e.height&&(c=!0)):(b=(e.x0-E)*
D,d=(e.y0-B)*w,r>b&&r<b+e.width*D&&s>d&&s<d+e.height*w&&(c=!0)):r>e.x0&&r<e.x1&&s>e.y0&&s<e.y1&&(c=!0),c){oe(ub[f],"s");return}nb&&(Ra=!1,a.ctrlKey?(D-=.1*mc,w-=.1*mc):(D+=.1*mc,w+=.1*mc,D>nc&&(D=nc),w>nc&&(w=nc)),D<id||w<Jc?(D=id,w=Jc,ra=r,sa=s,B=E=0,X=R,ma=J,Vc=Vb=0):(E=(ra*D-r)/D,B=(sa*w-s)/w,X=Math.floor(R/w),B+X>R-Vb&&(B=R-Vb-X),ma=Math.floor(J/D),B=Math.round(B),E=Math.round(E),Vb=he,Vc=ie),me());oa();Da()}};this.toggleAutoRefresh=function(){tc?(Ja.innerHTML=Ja.label_off,null!=Ab&&clearInterval(Ab),
tc=!1):(Ja.innerHTML=Ja.label_on,Ab=setInterval("HAniS.reloadFOF();",od),tc=!0)};this.toggleLoopRock=function(){ac?(null!=Wa&&(Wa.innerHTML=Wa.label_on),ac=!1):(null!=Wa&&(Wa.innerHTML=Wa.label_off),ac=!0)};this.toggleExtrap=function(){na?(null!=va&&(va.innerHTML=va.label_on,V.style.cursor="default",null!=ia&&(ia.disabled=!1),Ca($b),ja=-1),na=!1,Da()):(null!=va&&(na=!0,Ub=null,V.style.cursor="crosshair",va.innerHTML=va.label_off,$b=cb,null!=ia&&(ia.disabled=!0),cb=!1,HAniS.resetZoom(),Fe(),Da()),
oa())};var Fe=function(){Hc=0;Ia=Array(2);Fa=Array(2);Ob=Array(2);ja=0;Ub=null;uc(0)},Ca=function(a){cb=!a;HAniS.toggleIsLooping()};this.doEnhance=function(a){if(Hb||sb){var b=ga[0].height,d=ga[0].width;a=parseInt(fa.value,10);var c,e,h,l;0<=a&&(c=za[a],e=Aa[a],h=Ba[a],l=Sc[a],rc[db]=a);for(var d=b*d*4,g=0;g<Pa.length;g++)if(ga[g].gotit){ga[g].gotit=!1;var m=zc[g].data,p=$c[g];if(0>a)for(var n=0;n<d;n+=4)m[n]=p[n],m[n+1]=p[n+1],m[n+2]=p[n+2],m[n+3]=p[n+3];else for(n=0;n<d;n+=4)b=p[n],b===p[n+1]&&
b===p[n+2]&&(m[n]=c[b],m[n+1]=e[b],m[n+2]=h[b],m[n+3]=l[b]);tb[g].putImageData(zc[g],0,0);ga[g].gotit=!0}}};this.overClick=function(a){var b;if(a.target.checked)for(b=0;b<x.length;b++)a.target!=x[b]&&0!=a.target.name&&a.target.name==x[b].name&&(x[b].checked=!1);Jb=!0;for(b=0;b<qa.length;b++)a.target!=x[b]&&le(b),null!=fb&&!fb[b]&&x[b].checked&&(Jb=!1),null!=fa&&b==db&&(fa.disabled=!x[b].checked);oa()};this.toggleIsLooping=function(){cb?(cb=!1,null!=ia&&(ia.innerHTML=ia.label_on)):(cb=!0,null!=ia&&
(ia.innerHTML=ia.label_off))};this.toggleZooming=function(){nb?HAniS.resetZoom():(mb.innerHTML=mb.label_off,nb=!0,null!=xa&&(Ya=!1,xa.innerHTML=xa.label_on),Ra=!1,na&&HAniS.toggleExtrap())};var Wb=function(a,b){dc[a]=b;if(Cc){var d=yd+a*(Ib+Bc),c=Cd;0==b?c=Bd:-1==b&&(c=Ad);Fd.fillStyle=c;Fd.fillRect(d,Ac/2,Ib,Ac)}};this.togclick=function(a){var b=zd.getX();zd.getY();var d=yd;for(a=0;a<dc.length;a++){if(b>d&&b<d+Ib){b=0;0<=dc[a]&&(b=-1);Wb(a,b);break}d=d+Ib+Bc}};var Le=function(a){Cc&&(Ec.width=F,
yd=F/2-a*(Ib+Bc)/2);for(var b=0;b<a;b++)null!=Dc&&"n"==Dc[b].toLowerCase().trim()?Wb(b,-1):Wb(b,0)},uc=function(a){Wb(v,0);v=a;Wb(v,1)},Wc=function(a){Wb(v,0);do 0<a?(v+=1,v>=p&&(ac?(v=p-1,Gb=-Gb):v=0)):(v-=1,0>v&&(ac?(v=0,Gb=-Gb):v=p-1));while(0>dc[v]);Wb(v,1);null!=hb&&null!=Ua&&null!=Ua[v]&&(hb.innerHTML=Ua[v])},vc=function(a,b,d,c,h){e.globalAlpha=1;e.font=a.font;var m=a.fontHeight;d=d-m-6;var l=e.measureText(c).width;1==h&&(b-=l);0==h&&(b-=l/2);5>b&&(b=5);5>d&&(d=5);d+m+3>M&&(d=M-m-6);b+3+l>
F&&(b=F-l-6);e.save();e.beginPath();e.fillStyle=a.bg;null!=a.scolor&&(e.shadowColor=a.scolor,e.shadowBlur=a.sblur,e.shadowOffsetX=a.sxoff,e.shadowOffsetY=a.syoff);Rd=b-3;se=d;te=l+6;Sd=m+6;e.fillRect(Rd,se,te,Sd);e.closePath();e.restore();e.textBaseline="bottom";e.fillStyle=a.fg;e.fillText(c,b,d+m+3)},Da=function(){e.clearRect(0,0,F,M);ed=!1;if(na){e.beginPath();e.lineWidth=2;e.strokeStyle="white";var a=ja;1<a&&(a=2);for(var b=0;b<a;b++)1<ja&&(e.moveTo(Ia[0],Fa[0]),e.lineTo(Ia[1],Fa[1])),e.moveTo(Ia[b]-
15,Fa[b]),e.lineTo(Ia[b]+15,Fa[b]),e.moveTo(Ia[b],Fa[b]-15),e.lineTo(Ia[b],Fa[b]+15);e.closePath();e.stroke();if(3==ja){var d=H,c=I;e.moveTo(d,c);e.fillStyle=lb;e.fillRect(d-2,c-2,5,5);for(var b=Pb,a=Math.round(d+hc*Gc*(Pb-Ob[1])),h=Math.round(c+hc*ic*(Pb-Ob[1])),m=0;300>m;m++){e.beginPath();e.lineWidth=1;e.strokeStyle=lb;e.moveTo(d,c);e.lineTo(a,h);e.stroke();e.beginPath();e.lineWidth=3;e.rect(a-2,h-2,5,5);e.stroke();if(3>a||a+3>F||3>h||h+3>M)break;c=wa+b;c=100*Math.floor(c/60)+c%60;c%=2400;Md?(d=
"AM",1200<=c?(1300<=c&&(c-=1200),d="PM"):100>c&&(c+=1200),d=Math.floor(c/100)+":"+Math.floor(Math.floor(c%100)/10)+Math.floor(c%10)+" "+d):(d=c+" ",1E3>c&&(d="0"+c),100>c&&(d="00"+c),10>c&&(d="000"+c));c=0;Math.abs(hd)<Qb+5&&(c=45*.0174533);var l=h;0>Kd*hd&&0==c&&(l=h+Qb);e.font=lc;var d=d+" "+Ld,g=e.measureText(d).width;e.fillStyle=kc;0===c?(e.fillRect(a+2,l-Qb-2+c,g+4,Qb+3),e.fillStyle=lb,e.textBaseline="bottom",e.fillText(d,a+5,l)):(e.save(),e.translate(a+5,h),e.rotate(c),e.fillRect(2,-2,g+4,Qb+
3),e.fillStyle=lb,e.textBaseline="bottom",e.fillText(d,5,Qb),e.restore());d=a;c=h;a=Math.round(d+hc*Kd);h=Math.round(c+hc*hd);b+=u}}null!=Ub&&vc(ld,we,xe,Ub,0);vc(re,999,10,Hd[Hc],0);Gd=Rd;Id=Sd}Rb&&(b=vb*(Mc-oc)/D,a=Pc*(Nc-pc)/w,b=" "+Math.sqrt(b*b+a*a).toFixed(Qd)+" "+Ud+" ",vc(ue,oc/A,pc/C,b,-1),e.beginPath(),e.strokeStyle=Td,e.lineWidth=3,e.moveTo(Mc/A,Nc/C),e.lineTo(oc/A,pc/C),e.stroke(),e.closePath());Na&&vc(Vd,vd,wd,ud,-1);if(Sb&&(H=O.getX(),r=H*A,I=O.getY(),s=I*C,0<=r&&0<=s))for(ra=Math.round(E+
r/D),sa=Math.round(B+s/w),a=0;a<N;a++)if(P[v][a].gotit&&x[a].checked&&(a==db||null!=rc[a]&&0<=rc[a])){K.clearRect(0,0,1,1);a==db?K.drawImage(Pa[v],ra,sa,1,1,0,0,1,1):K.drawImage(P[v][a],ra,sa,1,1,0,0,1,1);y=K.getImageData(0,0,1,1).data;Rc=999;z=rc[a];h=Zd;if(0==y[3])h=fe[z];else{if(a==db)be=0,ob=y[0],Rc=0;else for(b=0;b<ya[z].length-1;b++)ab[0]=y[0]-za[z][b],0>ab[0]*(za[z][b+1]-y[0]-1)||(ab[1]=y[1]-Aa[z][b],0>ab[1]*(Aa[z][b+1]-y[1]-1)||(ab[2]=y[2]-Ba[z][b],0>ab[2]*(Ba[z][b+1]-y[2]-1)||(Tb=nd[z][b],
md=ab[Tb]/zb[z][b][Tb],ee=Math.abs(ab[ce[Tb]]-md*zb[z][b][ce[Tb]])+Math.abs(ab[de[Tb]]-md*zb[z][b][de[Tb]]),ee<Rc&&(ob=b,Rc=ee,be=md))));if(999>Rc)h=yb[z][ob],-1!=$a[z][ob]&&(h=h+" "+(ya[z][ob]+be*(ya[z][ob+1]-ya[z][ob])).toFixed($a[z][ob])+" "+xb[z][ob]);else if(1<sc){for(b=0;b<ya[z].length-1;b++)if(Math.abs(y[0]-za[z][b])<sc&&Math.abs(y[1]-Aa[z][b])<sc&&Math.abs(y[2]-Ba[z][b])<sc){h=yb[z][b];-1!=$a[z][b]&&(h=h+" "+ya[z][b].toFixed($a[z][b])+" "+xb[z][b]);break}U("RGB err: R="+y[0]+" G="+y[1]+" B="+
y[2])}}vc(ve,H-10,I,h,1)}!Ra||na||Ya||Sb||null==L||(e.drawImage(L.can,0,0,L.width,L.height,L.xmin/A,L.ymin/C,L.width/A,L.height/C),vc(Vd,(L.xmin+L.xmax)/2/A,(L.ymin+L.ymax)/2/C,L.tip,0),ed=!0)},oa=function(){var a;if(fd)try{m.clearRect(0,0,F,M);m.globalAlpha=1;if(gc&&null!=Sa&&0<=Y&&Sa[Y].gotit)m.drawImage(Sa[Y],E*ua[Y],B*ua[Y],ma*ua[Y],X*ua[Y],0,0,F,M);else if(la[v].gotit&&m.drawImage(la[v],E,B,ma,X,0,0,F,M),null!=aa&&(m.globalAlpha=1,la[v].gotit))for(var b=0;b<aa.length;b+=4)m.drawImage(la[v],aa[b],
aa[b+1],aa[b+2],aa[b+3],aa[b],aa[b+1],aa[b+2],aa[b+3]);if(0<N){for(b=0;b<N;b++)a=null!=Ha?Ha[b]:b,x[a].checked&&(gc&&null!=Ta&&0<=Y&&Ta[Y].gotit&&Ed==a?m.drawImage(Ta[Y],E*ua[Y],B*ua[Y],ma*ua[Y],X*ua[Y],0,0,F,M):P[v][a].gotit&&(null!=xc&&(m.globalAlpha=xc[a]),null==qc||qc[a]?m.drawImage(P[v][a],E,B,ma,X,0,0,F,M):m.drawImage(P[v][a],0,0,J,R,0,0,F,M)));if(null!=Za)for(m.globalAlpha=1,b=0;b<N;b++)a=null!=Ha?Ha[b]:b,P[v][a].gotit&&x[a].checked&&Za[a]&&m.drawImage(P[v][a],S[a][0],S[a][1],S[a][2],S[a][3],
S[a][0],S[a][1],S[a][2],S[a][3]);Sb&&Da()}ge&&Xc();if(sd){m.globalAlpha=1;var c;for(a=0;a<Qa;a++)c=ub[a],null!=c.icon&&c.icon.gotit&&(c.isPan?m.drawImage(c.icon,0,0,c.width,c.height,((c.x0-E)*D-c.w2)/A,((c.y0-B)*w-c.h2)/C,c.width/A,c.height/C):m.drawImage(c.icon,0,0,c.width,c.height,c.x0/A,c.y0/C,c.width/A,c.height/A))}}catch(e){U("Error:"+e)}},Xc=function(){if(pd&&Bb>Ga){m.save();m.fillStyle="blue";m.strokeStyle="white";m.lineWidth=3;m.strokeRect(Tc,Uc,200,14);m.fillRect(Tc,Uc,Ga/Bb*200,14);var a=
m.measureText("Loading images").width;m.fillStyle="orange";m.font="14px arial";m.fillText("Loading images",Tc+100-a/2,Uc+11);m.restore()}else ge=!1},U=function(a){if(Ka&&pb&&!pb.closed)try{pb.document.write(a+"<br>")}catch(b){}},Ee=function(){cb&&Wc(Gb);qe=v==p-1?xd+ea:ea;oa();setTimeout(function(){He(Ee)},qe)}};
